<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Functions Introduction | Multivariate Statistical Analysis Cookbook with R</title>
  <meta name="description" content="This is a final cookbook of Multivariate Statistical Analysis" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Functions Introduction | Multivariate Statistical Analysis Cookbook with R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a final cookbook of Multivariate Statistical Analysis" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Functions Introduction | Multivariate Statistical Analysis Cookbook with R" />
  
  <meta name="twitter:description" content="This is a final cookbook of Multivariate Statistical Analysis" />
  

<meta name="author" content="Yile Wang" />


<meta name="date" content="2020-12-10" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="intro.html"/>
<link rel="next" href="Data-Intro.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">MSA</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#main-packages"><i class="fa fa-check"></i><b>1.1</b> Main Packages</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#msa-introduction"><i class="fa fa-check"></i><b>1.2</b> MSA Introduction</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#msadata"><i class="fa fa-check"></i><b>1.3</b> MSA data set</a></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#whoo-hoo"><i class="fa fa-check"></i><b>1.4</b> Whoo-hoo!</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="Functions.html"><a href="Functions.html"><i class="fa fa-check"></i><b>2</b> Functions Introduction</a><ul>
<li class="chapter" data-level="2.1" data-path="Functions.html"><a href="Functions.html#Scree"><i class="fa fa-check"></i><b>2.1</b> Plotting Scree plot</a></li>
<li class="chapter" data-level="2.2" data-path="Functions.html"><a href="Functions.html#Permutation"><i class="fa fa-check"></i><b>2.2</b> Plotting Permutation test results</a></li>
<li class="chapter" data-level="2.3" data-path="Functions.html"><a href="Functions.html#Heatmap"><i class="fa fa-check"></i><b>2.3</b> Plotting Heatmap</a></li>
<li class="chapter" data-level="2.4" data-path="Functions.html"><a href="Functions.html#FactorScores"><i class="fa fa-check"></i><b>2.4</b> Plotting Row Factor Scores</a></li>
<li class="chapter" data-level="2.5" data-path="Functions.html"><a href="Functions.html#CFactorScore"><i class="fa fa-check"></i><b>2.5</b> Plotting Column Plot</a></li>
<li class="chapter" data-level="2.6" data-path="Functions.html"><a href="Functions.html#Loading"><i class="fa fa-check"></i><b>2.6</b> Plotting Loading Plot</a></li>
<li class="chapter" data-level="2.7" data-path="Functions.html"><a href="Functions.html#Contribution"><i class="fa fa-check"></i><b>2.7</b> Plotting Contribution Barplot</a></li>
<li class="chapter" data-level="2.8" data-path="Functions.html"><a href="Functions.html#binshelper"><i class="fa fa-check"></i><b>2.8</b> Bins Helper Functions</a></li>
<li class="chapter" data-level="2.9" data-path="Functions.html"><a href="Functions.html#plotting-latent-variable-plot"><i class="fa fa-check"></i><b>2.9</b> Plotting Latent Variable Plot</a></li>
<li class="chapter" data-level="2.10" data-path="Functions.html"><a href="Functions.html#plotting-partial-factor-scores"><i class="fa fa-check"></i><b>2.10</b> Plotting Partial Factor Scores</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="Data-Intro.html"><a href="Data-Intro.html"><i class="fa fa-check"></i><b>3</b> Data Introduction</a><ul>
<li class="chapter" data-level="3.1" data-path="Data-Intro.html"><a href="Data-Intro.html#collect"><i class="fa fa-check"></i><b>3.1</b> Main data set: Collective Action Data Set</a></li>
<li class="chapter" data-level="3.2" data-path="Data-Intro.html"><a href="Data-Intro.html#sausage"><i class="fa fa-check"></i><b>3.2</b> Low Income Sausage</a></li>
<li class="chapter" data-level="3.3" data-path="Data-Intro.html"><a href="Data-Intro.html#wines"><i class="fa fa-check"></i><b>3.3</b> Wines</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="pca.html"><a href="pca.html"><i class="fa fa-check"></i><b>4</b> Principal Component Analysis</a><ul>
<li class="chapter" data-level="4.1" data-path="pca.html"><a href="pca.html#introduction-of-pca"><i class="fa fa-check"></i><b>4.1</b> Introduction of PCA</a></li>
<li class="chapter" data-level="4.2" data-path="pca.html"><a href="pca.html#computing"><i class="fa fa-check"></i><b>4.2</b> Computing</a></li>
<li class="chapter" data-level="4.3" data-path="pca.html"><a href="pca.html#heatmap"><i class="fa fa-check"></i><b>4.3</b> Heatmap</a></li>
<li class="chapter" data-level="4.4" data-path="pca.html"><a href="pca.html#pcaScree"><i class="fa fa-check"></i><b>4.4</b> Scree Plot</a></li>
<li class="chapter" data-level="4.5" data-path="pca.html"><a href="pca.html#factor-scores"><i class="fa fa-check"></i><b>4.5</b> Factor Scores</a></li>
<li class="chapter" data-level="4.6" data-path="pca.html"><a href="pca.html#loading"><i class="fa fa-check"></i><b>4.6</b> Loading</a></li>
<li class="chapter" data-level="4.7" data-path="pca.html"><a href="pca.html#contriution-and-bootstrap-ratio-barplots"><i class="fa fa-check"></i><b>4.7</b> Contriution and Bootstrap Ratio Barplots</a></li>
<li class="chapter" data-level="4.8" data-path="pca.html"><a href="pca.html#conclusion"><i class="fa fa-check"></i><b>4.8</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="ca.html"><a href="ca.html"><i class="fa fa-check"></i><b>5</b> Correspondence Analysis</a><ul>
<li class="chapter" data-level="5.1" data-path="ca.html"><a href="ca.html#introduction-of-ca"><i class="fa fa-check"></i><b>5.1</b> Introduction of CA</a></li>
<li class="chapter" data-level="5.2" data-path="ca.html"><a href="ca.html#computation"><i class="fa fa-check"></i><b>5.2</b> Computation</a></li>
<li class="chapter" data-level="5.3" data-path="ca.html"><a href="ca.html#heatmap-1"><i class="fa fa-check"></i><b>5.3</b> Heatmap</a></li>
<li class="chapter" data-level="5.4" data-path="ca.html"><a href="ca.html#computation-1"><i class="fa fa-check"></i><b>5.4</b> Computation</a></li>
<li class="chapter" data-level="5.5" data-path="ca.html"><a href="ca.html#scree-plot"><i class="fa fa-check"></i><b>5.5</b> Scree Plot</a></li>
<li class="chapter" data-level="5.6" data-path="ca.html"><a href="ca.html#symmetric-asymmetric-plots"><i class="fa fa-check"></i><b>5.6</b> Symmetric &amp; Asymmetric Plots</a></li>
<li class="chapter" data-level="5.7" data-path="ca.html"><a href="ca.html#contribution-and-bootstrap-ratio-barplot"><i class="fa fa-check"></i><b>5.7</b> Contribution and Bootstrap Ratio Barplot</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="dica.html"><a href="dica.html"><i class="fa fa-check"></i><b>6</b> Discriminant Correspondence Analysis</a><ul>
<li class="chapter" data-level="6.1" data-path="dica.html"><a href="dica.html#introdcution-of-dica"><i class="fa fa-check"></i><b>6.1</b> Introdcution of DiCA</a></li>
<li class="chapter" data-level="6.2" data-path="dica.html"><a href="dica.html#histgram-of-binning-variables"><i class="fa fa-check"></i><b>6.2</b> Histgram of Binning Variables</a></li>
<li class="chapter" data-level="6.3" data-path="dica.html"><a href="dica.html#heatmap-2"><i class="fa fa-check"></i><b>6.3</b> Heatmap</a></li>
<li class="chapter" data-level="6.4" data-path="dica.html"><a href="dica.html#scree-plot-1"><i class="fa fa-check"></i><b>6.4</b> Scree Plot</a></li>
<li class="chapter" data-level="6.5" data-path="dica.html"><a href="dica.html#factor-scores-1"><i class="fa fa-check"></i><b>6.5</b> Factor Scores</a></li>
<li class="chapter" data-level="6.6" data-path="dica.html"><a href="dica.html#confusion-matrix"><i class="fa fa-check"></i><b>6.6</b> Confusion Matrix</a></li>
<li class="chapter" data-level="6.7" data-path="dica.html"><a href="dica.html#contribution-and-bootstrap-ratio-barplots"><i class="fa fa-check"></i><b>6.7</b> Contribution and Bootstrap Ratio Barplots</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="bada.html"><a href="bada.html"><i class="fa fa-check"></i><b>7</b> Barycentric Discriminant Analysis</a><ul>
<li class="chapter" data-level="7.1" data-path="bada.html"><a href="bada.html#introduction-of-bada"><i class="fa fa-check"></i><b>7.1</b> Introduction of BADA</a></li>
<li class="chapter" data-level="7.2" data-path="bada.html"><a href="bada.html#computation-2"><i class="fa fa-check"></i><b>7.2</b> Computation</a></li>
<li class="chapter" data-level="7.3" data-path="bada.html"><a href="bada.html#heatmap-3"><i class="fa fa-check"></i><b>7.3</b> Heatmap</a></li>
<li class="chapter" data-level="7.4" data-path="bada.html"><a href="bada.html#scree"><i class="fa fa-check"></i><b>7.4</b> Scree</a></li>
<li class="chapter" data-level="7.5" data-path="bada.html"><a href="bada.html#factor-scores-2"><i class="fa fa-check"></i><b>7.5</b> Factor Scores</a></li>
<li class="chapter" data-level="7.6" data-path="bada.html"><a href="bada.html#loading-1"><i class="fa fa-check"></i><b>7.6</b> Loading</a></li>
<li class="chapter" data-level="7.7" data-path="bada.html"><a href="bada.html#confusion-matrix-1"><i class="fa fa-check"></i><b>7.7</b> Confusion Matrix</a></li>
<li class="chapter" data-level="7.8" data-path="bada.html"><a href="bada.html#contribution-and-bootstrap-ratio-barplot-1"><i class="fa fa-check"></i><b>7.8</b> Contribution and Bootstrap Ratio Barplot</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="mca.html"><a href="mca.html"><i class="fa fa-check"></i><b>8</b> Multiple Corresponding Analysis</a><ul>
<li class="chapter" data-level="8.1" data-path="mca.html"><a href="mca.html#introduction-of-mca"><i class="fa fa-check"></i><b>8.1</b> Introduction of MCA</a></li>
<li class="chapter" data-level="8.2" data-path="mca.html"><a href="mca.html#histgram-of-binning-variables-1"><i class="fa fa-check"></i><b>8.2</b> Histgram of Binning Variables</a></li>
<li class="chapter" data-level="8.3" data-path="mca.html"><a href="mca.html#computation-3"><i class="fa fa-check"></i><b>8.3</b> Computation</a></li>
<li class="chapter" data-level="8.4" data-path="mca.html"><a href="mca.html#heatmap-4"><i class="fa fa-check"></i><b>8.4</b> Heatmap</a></li>
<li class="chapter" data-level="8.5" data-path="mca.html"><a href="mca.html#scree-plot-2"><i class="fa fa-check"></i><b>8.5</b> Scree Plot</a></li>
<li class="chapter" data-level="8.6" data-path="mca.html"><a href="mca.html#row-factor-scores"><i class="fa fa-check"></i><b>8.6</b> Row Factor Scores</a></li>
<li class="chapter" data-level="8.7" data-path="mca.html"><a href="mca.html#important-variables-line-plots"><i class="fa fa-check"></i><b>8.7</b> Important Variables Line Plots</a></li>
<li class="chapter" data-level="8.8" data-path="mca.html"><a href="mca.html#contribution-and-bootstrap-ratio-barplots-1"><i class="fa fa-check"></i><b>8.8</b> Contribution and Bootstrap Ratio Barplots</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="pls.html"><a href="pls.html"><i class="fa fa-check"></i><b>9</b> Partial Least Square</a><ul>
<li class="chapter" data-level="9.1" data-path="pls.html"><a href="pls.html#introduction-of-pls-c"><i class="fa fa-check"></i><b>9.1</b> Introduction of PLS-C</a></li>
<li class="chapter" data-level="9.2" data-path="pls.html"><a href="pls.html#computation-4"><i class="fa fa-check"></i><b>9.2</b> Computation</a></li>
<li class="chapter" data-level="9.3" data-path="pls.html"><a href="pls.html#heatmap-5"><i class="fa fa-check"></i><b>9.3</b> Heatmap</a></li>
<li class="chapter" data-level="9.4" data-path="pls.html"><a href="pls.html#scree-plot-3"><i class="fa fa-check"></i><b>9.4</b> Scree Plot</a></li>
<li class="chapter" data-level="9.5" data-path="pls.html"><a href="pls.html#latent-variables"><i class="fa fa-check"></i><b>9.5</b> Latent Variables</a></li>
<li class="chapter" data-level="9.6" data-path="pls.html"><a href="pls.html#salience"><i class="fa fa-check"></i><b>9.6</b> Salience</a></li>
<li class="chapter" data-level="9.7" data-path="pls.html"><a href="pls.html#bootstrap-ratio-barplot"><i class="fa fa-check"></i><b>9.7</b> Bootstrap Ratio Barplot</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="distatis.html"><a href="distatis.html"><i class="fa fa-check"></i><b>10</b> DiSTATIS</a><ul>
<li class="chapter" data-level="10.1" data-path="distatis.html"><a href="distatis.html#introduction-of-distatis"><i class="fa fa-check"></i><b>10.1</b> Introduction of DiSTATIS</a></li>
<li class="chapter" data-level="10.2" data-path="distatis.html"><a href="distatis.html#computation-5"><i class="fa fa-check"></i><b>10.2</b> Computation</a></li>
<li class="chapter" data-level="10.3" data-path="distatis.html"><a href="distatis.html#heatmap-6"><i class="fa fa-check"></i><b>10.3</b> HeatMap</a></li>
<li class="chapter" data-level="10.4" data-path="distatis.html"><a href="distatis.html#scree-plot-4"><i class="fa fa-check"></i><b>10.4</b> Scree Plot</a></li>
<li class="chapter" data-level="10.5" data-path="distatis.html"><a href="distatis.html#global-factor-scores"><i class="fa fa-check"></i><b>10.5</b> Global Factor Scores</a></li>
<li class="chapter" data-level="10.6" data-path="distatis.html"><a href="distatis.html#partial-factor-scores"><i class="fa fa-check"></i><b>10.6</b> Partial Factor Scores</a></li>
<li class="chapter" data-level="10.7" data-path="distatis.html"><a href="distatis.html#vocabulary-graphs"><i class="fa fa-check"></i><b>10.7</b> Vocabulary graphs</a></li>
<li class="chapter" data-level="10.8" data-path="distatis.html"><a href="distatis.html#contribution-barplots"><i class="fa fa-check"></i><b>10.8</b> Contribution Barplots</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="mfa.html"><a href="mfa.html"><i class="fa fa-check"></i><b>11</b> Multiple Factor Analysis</a><ul>
<li class="chapter" data-level="11.1" data-path="mfa.html"><a href="mfa.html#introduction-of-mfa"><i class="fa fa-check"></i><b>11.1</b> Introduction of MFA</a></li>
<li class="chapter" data-level="11.2" data-path="mfa.html"><a href="mfa.html#computation-6"><i class="fa fa-check"></i><b>11.2</b> Computation</a></li>
<li class="chapter" data-level="11.3" data-path="mfa.html"><a href="mfa.html#heatmap-7"><i class="fa fa-check"></i><b>11.3</b> Heatmap</a></li>
<li class="chapter" data-level="11.4" data-path="mfa.html"><a href="mfa.html#scree-plot-5"><i class="fa fa-check"></i><b>11.4</b> Scree Plot</a></li>
<li class="chapter" data-level="11.5" data-path="mfa.html"><a href="mfa.html#global-factor-scores-1"><i class="fa fa-check"></i><b>11.5</b> Global Factor Scores</a></li>
<li class="chapter" data-level="11.6" data-path="mfa.html"><a href="mfa.html#partial-factor-scores-1"><i class="fa fa-check"></i><b>11.6</b> Partial Factor Scores</a></li>
<li class="chapter" data-level="11.7" data-path="mfa.html"><a href="mfa.html#contribution-barplots-1"><i class="fa fa-check"></i><b>11.7</b> Contribution Barplots</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="end.html"><a href="end.html"><i class="fa fa-check"></i><b>12</b> The End</a><ul>
<li class="chapter" data-level="12.1" data-path="end.html"><a href="end.html#final-conclusion"><i class="fa fa-check"></i><b>12.1</b> Final Conclusion</a></li>
<li class="chapter" data-level="12.2" data-path="end.html"><a href="end.html#appreciation"><i class="fa fa-check"></i><b>12.2</b> Appreciation</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown/_book" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Multivariate Statistical Analysis Cookbook with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="Functions" class="section level1">
<h1><span class="header-section-number">Chapter 2</span> Functions Introduction</h1>
<p>In this Chapter, I list some of important functions for plotting. These functions are mainly based on packages <code>PTCA4CATA</code> and <code>data4PCCAR</code>, which are developed by Dr. Herve Abdi and his team at The University of Texas at Dallas. These functions will provide computational convenience to my plotting and visualization of my results. It is worth to mention that these functions are designed to generate plots so users should conduct MSA before using these functions. For how to conduct MSA in R, please see each chapter in this book: PCA<sup><a href="pca.html#pca">4</a></sup>, CA<sup><a href="ca.html#ca">5</a></sup>, MCA<sup><a href="mca.html#mca">8</a></sup>, BADA<sup><a href="bada.html#bada">7</a></sup>, DiCA<sup><a href="dica.html#dica">6</a></sup>, PLS-C<sup><a href="pls.html#pls">9</a></sup>, DiSTATIS<sup><a href="distatis.html#distatis">10</a></sup> and MFA<sup><a href="mfa.html#mfa">11</a></sup>. For further information about the two basic packages, please visit <a href="https://github.com/HerveAbdi">Dr. Abdi’s github</a></p>
<div id="Scree" class="section level2">
<h2><span class="header-section-number">2.1</span> Plotting Scree plot</h2>
<p>The first function is designed to plot scree plot:</p>
<p><strong>Required parameters:</strong> eigs(eigenvalue), p.vals(inference p values)</p>
<p><strong>Output:</strong> Scree plot</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="Functions.html#cb2-1"></a>plot.scree &lt;-<span class="st"> </span><span class="cf">function</span>(eigs, p.vals){</span>
<span id="cb2-2"><a href="Functions.html#cb2-2"></a>  <span class="kw">PlotScree</span>(<span class="dt">ev =</span> eigs,</span>
<span id="cb2-3"><a href="Functions.html#cb2-3"></a>  <span class="dt">p.ev =</span> p.vals,</span>
<span id="cb2-4"><a href="Functions.html#cb2-4"></a>  <span class="dt">plotKaiser =</span> <span class="ot">TRUE</span>,</span>
<span id="cb2-5"><a href="Functions.html#cb2-5"></a>  <span class="dt">title =</span> <span class="st">&quot;Explained Variance per Dimension&quot;</span>)</span>
<span id="cb2-6"><a href="Functions.html#cb2-6"></a>}</span></code></pre></div>
</div>
<div id="Permutation" class="section level2">
<h2><span class="header-section-number">2.2</span> Plotting Permutation test results</h2>
<p>The second function is designed to plot the permutation histogram:</p>
<p><strong>Required parameters:</strong> eigs.perm(eigenvalue.permutation), eigs(eigenvalue), para1(x_lim for X axis, default = 5), para2(intervals of distribution, default = 20), Dim(number of dimension, default = 1).</p>
<p><strong>Output:</strong> Permutation Plots</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="Functions.html#cb3-1"></a>plot.permutation &lt;-<span class="st"> </span><span class="cf">function</span>(eigs.perm, eigs, </span>
<span id="cb3-2"><a href="Functions.html#cb3-2"></a>                             <span class="dt">para1 =</span> <span class="dv">5</span>,  <span class="dt">para2 =</span> <span class="dv">20</span>, </span>
<span id="cb3-3"><a href="Functions.html#cb3-3"></a>                             <span class="dt">Dim =</span> <span class="dv">1</span>){</span>
<span id="cb3-4"><a href="Functions.html#cb3-4"></a>  zeDim =<span class="st"> </span>Dim</span>
<span id="cb3-5"><a href="Functions.html#cb3-5"></a>  pH &lt;-<span class="st"> </span><span class="kw">prettyHist</span>(</span>
<span id="cb3-6"><a href="Functions.html#cb3-6"></a>    <span class="dt">distribution =</span> eigs.perm[,zeDim], </span>
<span id="cb3-7"><a href="Functions.html#cb3-7"></a>    <span class="dt">observed =</span> eigs[zeDim], </span>
<span id="cb3-8"><a href="Functions.html#cb3-8"></a>    <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>,para1), <span class="co"># needs to be set by hand</span></span>
<span id="cb3-9"><a href="Functions.html#cb3-9"></a>    <span class="dt">breaks =</span> para2,</span>
<span id="cb3-10"><a href="Functions.html#cb3-10"></a>    <span class="dt">border =</span> <span class="st">&quot;gray&quot;</span>, </span>
<span id="cb3-11"><a href="Functions.html#cb3-11"></a>    <span class="dt">main =</span> <span class="kw">paste0</span>(<span class="st">&quot;Permutation Test for Eigenvalue &quot;</span>,zeDim),</span>
<span id="cb3-12"><a href="Functions.html#cb3-12"></a>    <span class="dt">xlab =</span> <span class="kw">paste0</span>(<span class="st">&quot;Eigenvalue &quot;</span>,zeDim), </span>
<span id="cb3-13"><a href="Functions.html#cb3-13"></a>    <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>, </span>
<span id="cb3-14"><a href="Functions.html#cb3-14"></a>    <span class="dt">counts =</span> <span class="ot">FALSE</span>, </span>
<span id="cb3-15"><a href="Functions.html#cb3-15"></a>    <span class="dt">cutoffs =</span> <span class="kw">c</span>( <span class="fl">0.975</span>))</span>
<span id="cb3-16"><a href="Functions.html#cb3-16"></a>}</span></code></pre></div>
</div>
<div id="Heatmap" class="section level2">
<h2><span class="header-section-number">2.3</span> Plotting Heatmap</h2>
<p><strong>Required parameters:</strong> data1(data set 1), data2(data set 2), xcol(color of labels in X axis), ycol(color of labels in X axis), textsize(font size of the labels, default = 5)</p>
<p><strong>Output:</strong> Heatmap of correlation between two data sets.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="Functions.html#cb4-1"></a>plot.heatmap &lt;-<span class="st"> </span><span class="cf">function</span>(data1, data2, </span>
<span id="cb4-2"><a href="Functions.html#cb4-2"></a>                         <span class="dt">DATA=</span><span class="ot">NULL</span>, <span class="dt">xcol =</span> <span class="ot">NULL</span>, </span>
<span id="cb4-3"><a href="Functions.html#cb4-3"></a>                         <span class="dt">ycol =</span> <span class="ot">NULL</span>, <span class="dt">textsize =</span> <span class="dv">5</span>, </span>
<span id="cb4-4"><a href="Functions.html#cb4-4"></a>                         <span class="dt">scale =</span> <span class="ot">TRUE</span> ){</span>
<span id="cb4-5"><a href="Functions.html#cb4-5"></a>  <span class="cf">if</span>(<span class="kw">is.null</span>(DATA)){</span>
<span id="cb4-6"><a href="Functions.html#cb4-6"></a>  data1 &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(data1)</span>
<span id="cb4-7"><a href="Functions.html#cb4-7"></a>  data2 &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(data2)</span>
<span id="cb4-8"><a href="Functions.html#cb4-8"></a>  DATA =<span class="st"> </span><span class="kw">cor</span>(data1, data2)</span>
<span id="cb4-9"><a href="Functions.html#cb4-9"></a>  }</span>
<span id="cb4-10"><a href="Functions.html#cb4-10"></a>  <span class="cf">if</span>(<span class="kw">is.null</span>(xcol)){</span>
<span id="cb4-11"><a href="Functions.html#cb4-11"></a>    xcol &lt;-<span class="st"> </span><span class="kw">prettyGraphsColorSelection</span>(</span>
<span id="cb4-12"><a href="Functions.html#cb4-12"></a>      <span class="dt">n.colors =</span> <span class="kw">ncol</span>(DATA))</span>
<span id="cb4-13"><a href="Functions.html#cb4-13"></a>  }</span>
<span id="cb4-14"><a href="Functions.html#cb4-14"></a>  <span class="cf">if</span>(<span class="kw">is.null</span>(ycol)){</span>
<span id="cb4-15"><a href="Functions.html#cb4-15"></a>    ycol &lt;-<span class="st"> </span><span class="kw">prettyGraphsColorSelection</span>(</span>
<span id="cb4-16"><a href="Functions.html#cb4-16"></a>      <span class="dt">n.colors =</span> <span class="kw">nrow</span>(DATA))</span>
<span id="cb4-17"><a href="Functions.html#cb4-17"></a>  }</span>
<span id="cb4-18"><a href="Functions.html#cb4-18"></a>  hmap &lt;-<span class="st"> </span><span class="kw">superheat</span>(DATA, </span>
<span id="cb4-19"><a href="Functions.html#cb4-19"></a>            <span class="dt">heat.pal =</span> <span class="kw">c</span>(<span class="st">&quot;brown&quot;</span>, <span class="st">&quot;white&quot;</span>,<span class="st">&quot;red4&quot;</span>),</span>
<span id="cb4-20"><a href="Functions.html#cb4-20"></a>            <span class="dt">left.label.size =</span> <span class="fl">0.5</span>,</span>
<span id="cb4-21"><a href="Functions.html#cb4-21"></a>            <span class="dt">bottom.label.size =</span> <span class="fl">0.5</span>,</span>
<span id="cb4-22"><a href="Functions.html#cb4-22"></a>            <span class="dt">bottom.label.text.angle =</span> <span class="dv">90</span>,</span>
<span id="cb4-23"><a href="Functions.html#cb4-23"></a>            <span class="dt">left.label.text.alignment =</span> <span class="st">&quot;right&quot;</span>,</span>
<span id="cb4-24"><a href="Functions.html#cb4-24"></a>            <span class="dt">bottom.label.text.alignment =</span> <span class="st">&quot;right&quot;</span>, </span>
<span id="cb4-25"><a href="Functions.html#cb4-25"></a>            <span class="dt">bottom.label.text.col =</span> xcol,</span>
<span id="cb4-26"><a href="Functions.html#cb4-26"></a>            <span class="dt">left.label.text.col =</span> ycol,</span>
<span id="cb4-27"><a href="Functions.html#cb4-27"></a>            <span class="dt">grid.vline =</span> <span class="ot">FALSE</span>,</span>
<span id="cb4-28"><a href="Functions.html#cb4-28"></a>            <span class="dt">grid.hline =</span> <span class="ot">FALSE</span>, </span>
<span id="cb4-29"><a href="Functions.html#cb4-29"></a>            <span class="dt">bottom.label.col =</span> <span class="st">&quot;white&quot;</span>, </span>
<span id="cb4-30"><a href="Functions.html#cb4-30"></a>            <span class="dt">left.label.col =</span> <span class="st">&quot;white&quot;</span>, </span>
<span id="cb4-31"><a href="Functions.html#cb4-31"></a>            <span class="dt">scale =</span> scale,</span>
<span id="cb4-32"><a href="Functions.html#cb4-32"></a>            <span class="dt">left.label.text.size =</span> textsize,</span>
<span id="cb4-33"><a href="Functions.html#cb4-33"></a>            <span class="dt">bottom.label.text.size =</span> textsize,</span>
<span id="cb4-34"><a href="Functions.html#cb4-34"></a>            )</span>
<span id="cb4-35"><a href="Functions.html#cb4-35"></a>}</span></code></pre></div>
</div>
<div id="FactorScores" class="section level2">
<h2><span class="header-section-number">2.4</span> Plotting Row Factor Scores</h2>
<p><strong>Required parameters:</strong> DESIGN(the grouping design of observation, such as <span style="background-color:yellow;">Lakers</span> is group1 and <span style="background-color:#33FF8B;">Celtics</span> is group2), fs(factor scores), eigenvalues, tau(Kendall rank correlation coefficient), d(dimension, default = 1), mode(do you want “hull” or “CI”?), method(The string you want to add on your graph’s title).</p>
<p><strong>Output:</strong> Global row factor scores map for each observation</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="Functions.html#cb5-1"></a>plot.fs &lt;-<span class="st"> </span><span class="cf">function</span>(DESIGN, fs, eigs, </span>
<span id="cb5-2"><a href="Functions.html#cb5-2"></a>                    tau, <span class="dt">d =</span> <span class="dv">1</span>, <span class="dt">mode=</span><span class="st">&quot;CI&quot;</span>,</span>
<span id="cb5-3"><a href="Functions.html#cb5-3"></a>                    <span class="dt">method =</span> <span class="st">&quot; &quot;</span>)</span>
<span id="cb5-4"><a href="Functions.html#cb5-4"></a>{</span>
<span id="cb5-5"><a href="Functions.html#cb5-5"></a>  fs &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(fs)</span>
<span id="cb5-6"><a href="Functions.html#cb5-6"></a>  <span class="co"># GETMEANS</span></span>
<span id="cb5-7"><a href="Functions.html#cb5-7"></a>  fm.tmp &lt;-<span class="st"> </span><span class="kw">aggregate</span>(fs, <span class="kw">list</span>(DESIGN), mean)</span>
<span id="cb5-8"><a href="Functions.html#cb5-8"></a>  fm &lt;-<span class="st"> </span>fm.tmp[,<span class="dv">2</span><span class="op">:</span><span class="kw">ncol</span>(fm.tmp)]</span>
<span id="cb5-9"><a href="Functions.html#cb5-9"></a>  <span class="kw">rownames</span>(fm) &lt;-<span class="st"> </span>fm.tmp[,<span class="dv">1</span>]</span>
<span id="cb5-10"><a href="Functions.html#cb5-10"></a>  tau &lt;-<span class="st"> </span><span class="kw">round</span>(tau)</span>
<span id="cb5-11"><a href="Functions.html#cb5-11"></a>  color.dot &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(DESIGN)</span>
<span id="cb5-12"><a href="Functions.html#cb5-12"></a>  na.de &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">levels</span>(DESIGN))</span>
<span id="cb5-13"><a href="Functions.html#cb5-13"></a>  num.de &lt;-<span class="st"> </span><span class="kw">length</span>(na.de)</span>
<span id="cb5-14"><a href="Functions.html#cb5-14"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="st"> </span>num.de){</span>
<span id="cb5-15"><a href="Functions.html#cb5-15"></a>    color.dot[<span class="kw">which</span>(color.dot <span class="op">==</span><span class="st"> </span>na.de[i])] &lt;-<span class="st"> </span>index[i]</span>
<span id="cb5-16"><a href="Functions.html#cb5-16"></a>  }</span>
<span id="cb5-17"><a href="Functions.html#cb5-17"></a>  color.dot &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(color.dot)</span>
<span id="cb5-18"><a href="Functions.html#cb5-18"></a>  <span class="kw">rownames</span>(color.dot) &lt;-<span class="st"> </span>DESIGN</span>
<span id="cb5-19"><a href="Functions.html#cb5-19"></a>  fs.plot &lt;-<span class="st"> </span><span class="kw">createFactorMap</span>(fs, <span class="co"># data</span></span>
<span id="cb5-20"><a href="Functions.html#cb5-20"></a>                           <span class="dt">title =</span> <span class="kw">paste0</span>(<span class="st">&quot;Factor Scores_&quot;</span>,</span>
<span id="cb5-21"><a href="Functions.html#cb5-21"></a>                                          method), </span>
<span id="cb5-22"><a href="Functions.html#cb5-22"></a>                           <span class="dt">alpha.points =</span> <span class="fl">0.3</span>,</span>
<span id="cb5-23"><a href="Functions.html#cb5-23"></a>                           <span class="dt">axis1 =</span> d, <span class="dt">axis2 =</span> (d<span class="op">+</span><span class="dv">1</span>), </span>
<span id="cb5-24"><a href="Functions.html#cb5-24"></a>                           <span class="dt">pch =</span> <span class="dv">19</span>, </span>
<span id="cb5-25"><a href="Functions.html#cb5-25"></a>                           <span class="dt">cex =</span> <span class="dv">2</span>,</span>
<span id="cb5-26"><a href="Functions.html#cb5-26"></a>                           <span class="dt">text.cex =</span> <span class="fl">2.5</span>, </span>
<span id="cb5-27"><a href="Functions.html#cb5-27"></a>                           <span class="dt">display.labels =</span> <span class="ot">FALSE</span>,</span>
<span id="cb5-28"><a href="Functions.html#cb5-28"></a>                           <span class="dt">col.points =</span> color.dot, </span>
<span id="cb5-29"><a href="Functions.html#cb5-29"></a>                           <span class="dt">col.labels =</span>  color.dot</span>
<span id="cb5-30"><a href="Functions.html#cb5-30"></a> )</span>
<span id="cb5-31"><a href="Functions.html#cb5-31"></a>  fs.label &lt;-<span class="st"> </span><span class="kw">createxyLabels.gen</span>(d,(d<span class="op">+</span><span class="dv">1</span>),</span>
<span id="cb5-32"><a href="Functions.html#cb5-32"></a>                               <span class="dt">lambda =</span> eigs,</span>
<span id="cb5-33"><a href="Functions.html#cb5-33"></a>                               <span class="dt">tau =</span> tau,</span>
<span id="cb5-34"><a href="Functions.html#cb5-34"></a>                               <span class="dt">axisName =</span> <span class="st">&quot;Component &quot;</span></span>
<span id="cb5-35"><a href="Functions.html#cb5-35"></a> )</span>
<span id="cb5-36"><a href="Functions.html#cb5-36"></a>  ind &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span>num.de)</span>
<span id="cb5-37"><a href="Functions.html#cb5-37"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>num.de){</span>
<span id="cb5-38"><a href="Functions.html#cb5-38"></a>    inde &lt;-<span class="st"> </span><span class="kw">match</span>(<span class="kw">rownames</span>(color.dot), </span>
<span id="cb5-39"><a href="Functions.html#cb5-39"></a>                  <span class="kw">sort</span>(<span class="kw">rownames</span>(fm)))</span>
<span id="cb5-40"><a href="Functions.html#cb5-40"></a>    ind[i] &lt;-<span class="st"> </span><span class="kw">which</span>(inde <span class="op">==</span><span class="st"> </span>i)[<span class="dv">1</span>]</span>
<span id="cb5-41"><a href="Functions.html#cb5-41"></a>  }</span>
<span id="cb5-42"><a href="Functions.html#cb5-42"></a>  grp.ind &lt;-<span class="st"> </span>ind</span>
<span id="cb5-43"><a href="Functions.html#cb5-43"></a>  <span class="kw">rownames</span>(fm[<span class="kw">sort</span>(<span class="kw">rownames</span>(fm)),]) &lt;-<span class="st"> </span><span class="kw">sub</span>(<span class="st">&quot;[[:punct:]]&quot;</span>,<span class="st">&quot;&quot;</span>,</span>
<span id="cb5-44"><a href="Functions.html#cb5-44"></a>                                       <span class="kw">rownames</span>(fm[<span class="kw">sort</span>(<span class="kw">rownames</span>(fm)),]))</span>
<span id="cb5-45"><a href="Functions.html#cb5-45"></a>  </span>
<span id="cb5-46"><a href="Functions.html#cb5-46"></a>  graphs.means &lt;-<span class="st"> </span>PTCA4CATA<span class="op">::</span><span class="st"> </span><span class="kw">createFactorMap</span>(fm[<span class="kw">sort</span>(<span class="kw">rownames</span>(fm)),],</span>
<span id="cb5-47"><a href="Functions.html#cb5-47"></a>                                 <span class="dt">axis1 =</span> d, <span class="dt">axis2 =</span>(d<span class="op">+</span><span class="dv">1</span>), </span>
<span id="cb5-48"><a href="Functions.html#cb5-48"></a>                                 <span class="dt">constraints =</span> fs.plot<span class="op">$</span>constraints,</span>
<span id="cb5-49"><a href="Functions.html#cb5-49"></a>                                 <span class="dt">col.points =</span> color.dot[grp.ind],</span>
<span id="cb5-50"><a href="Functions.html#cb5-50"></a>                                 <span class="dt">col.labels =</span> color.dot[grp.ind],</span>
<span id="cb5-51"><a href="Functions.html#cb5-51"></a>                                 <span class="dt">alpha.points =</span> <span class="fl">0.9</span>)</span>
<span id="cb5-52"><a href="Functions.html#cb5-52"></a>  </span>
<span id="cb5-53"><a href="Functions.html#cb5-53"></a>  BootCube &lt;-<span class="st"> </span>PTCA4CATA<span class="op">::</span><span class="kw">Boot4Mean</span>(fs, </span>
<span id="cb5-54"><a href="Functions.html#cb5-54"></a>                                 <span class="dt">design =</span> <span class="kw">as.factor</span>(DESIGN), </span>
<span id="cb5-55"><a href="Functions.html#cb5-55"></a>                                 <span class="dt">niter =</span> <span class="dv">100</span>)</span>
<span id="cb5-56"><a href="Functions.html#cb5-56"></a></span>
<span id="cb5-57"><a href="Functions.html#cb5-57"></a>  <span class="kw">dimnames</span>(BootCube<span class="op">$</span>BootCube)[[<span class="dv">2</span>]] &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;dim &quot;</span>, </span>
<span id="cb5-58"><a href="Functions.html#cb5-58"></a>                                      <span class="dv">1</span><span class="op">:</span><span class="kw">dim</span>(BootCube<span class="op">$</span>BootCube)[[<span class="dv">2</span>]])</span>
<span id="cb5-59"><a href="Functions.html#cb5-59"></a>  </span>
<span id="cb5-60"><a href="Functions.html#cb5-60"></a>  boot.elli &lt;-<span class="st"> </span><span class="kw">MakeCIEllipses</span>(<span class="dt">data =</span></span>
<span id="cb5-61"><a href="Functions.html#cb5-61"></a>                                BootCube<span class="op">$</span>BootCube[,d<span class="op">:</span>(d<span class="op">+</span><span class="dv">1</span>),][<span class="kw">sort</span>(<span class="kw">rownames</span>(BootCube<span class="op">$</span>BootCube[,d<span class="op">:</span>(d<span class="op">+</span><span class="dv">1</span>),])),,],</span>
<span id="cb5-62"><a href="Functions.html#cb5-62"></a>                  <span class="dt">names.of.factors =</span> </span>
<span id="cb5-63"><a href="Functions.html#cb5-63"></a>                  <span class="kw">c</span>(<span class="kw">paste0</span>(<span class="st">&quot;Dimension &quot;</span>, d),<span class="kw">paste0</span>(<span class="st">&quot;Dimension &quot;</span>, </span>
<span id="cb5-64"><a href="Functions.html#cb5-64"></a>                  (d<span class="op">+</span><span class="dv">1</span>))),</span>
<span id="cb5-65"><a href="Functions.html#cb5-65"></a>                  <span class="dt">col =</span> color.dot[grp.ind],</span>
<span id="cb5-66"><a href="Functions.html#cb5-66"></a>                  <span class="dt">alpha.line =</span> <span class="fl">0.3</span>,</span>
<span id="cb5-67"><a href="Functions.html#cb5-67"></a>                  <span class="dt">alpha.ellipse =</span> <span class="fl">0.3</span></span>
<span id="cb5-68"><a href="Functions.html#cb5-68"></a> )</span>
<span id="cb5-69"><a href="Functions.html#cb5-69"></a>  </span>
<span id="cb5-70"><a href="Functions.html#cb5-70"></a>  <span class="co"># with Hull</span></span>
<span id="cb5-71"><a href="Functions.html#cb5-71"></a>  <span class="kw">colnames</span>(fs) &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&#39;Dimension &#39;</span>, <span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(fs))</span>
<span id="cb5-72"><a href="Functions.html#cb5-72"></a>  <span class="co"># getting the color correct: an ugly trick</span></span>
<span id="cb5-73"><a href="Functions.html#cb5-73"></a>  <span class="co">#col.groups &lt;- as.data.frame(col.groups)</span></span>
<span id="cb5-74"><a href="Functions.html#cb5-74"></a>  DESIGN &lt;-<span class="st"> </span><span class="kw">factor</span>(DESIGN, <span class="dt">levels =</span> DESIGN[grp.ind])</span>
<span id="cb5-75"><a href="Functions.html#cb5-75"></a>  GraphHull &lt;-<span class="st"> </span>PTCA4CATA<span class="op">::</span><span class="kw">MakeToleranceIntervals</span>(fs, </span>
<span id="cb5-76"><a href="Functions.html#cb5-76"></a>               <span class="dt">axis1 =</span> d, </span>
<span id="cb5-77"><a href="Functions.html#cb5-77"></a>               <span class="dt">axis2 =</span> (d<span class="op">+</span><span class="dv">1</span>),</span>
<span id="cb5-78"><a href="Functions.html#cb5-78"></a>               <span class="dt">design =</span> DESIGN,</span>
<span id="cb5-79"><a href="Functions.html#cb5-79"></a>               <span class="dt">col =</span> color.dot[grp.ind],</span>
<span id="cb5-80"><a href="Functions.html#cb5-80"></a>               <span class="dt">names.of.factors =</span>  <span class="kw">c</span>(<span class="kw">paste0</span>(<span class="st">&quot;Dim &quot;</span>, d),</span>
<span id="cb5-81"><a href="Functions.html#cb5-81"></a>                                     <span class="kw">paste0</span>(<span class="st">&quot;Dim 2&quot;</span>, (d<span class="op">+</span><span class="dv">1</span>))),</span>
<span id="cb5-82"><a href="Functions.html#cb5-82"></a>               <span class="dt">p.level =</span> <span class="fl">1.00</span>)</span>
<span id="cb5-83"><a href="Functions.html#cb5-83"></a>  </span>
<span id="cb5-84"><a href="Functions.html#cb5-84"></a>  <span class="cf">if</span> (mode <span class="op">==</span><span class="st"> &quot;hull&quot;</span>){</span>
<span id="cb5-85"><a href="Functions.html#cb5-85"></a>  factor.map &lt;-<span class="st"> </span>fs.plot<span class="op">$</span>zeMap_background <span class="op">+</span></span>
<span id="cb5-86"><a href="Functions.html#cb5-86"></a><span class="st">    </span>GraphHull <span class="op">+</span><span class="st"> </span></span>
<span id="cb5-87"><a href="Functions.html#cb5-87"></a><span class="st">    </span>fs.plot<span class="op">$</span>zeMap_dots <span class="op">+</span><span class="st"> </span></span>
<span id="cb5-88"><a href="Functions.html#cb5-88"></a><span class="st">    </span>fs.label <span class="op">+</span><span class="st">  </span></span>
<span id="cb5-89"><a href="Functions.html#cb5-89"></a><span class="st">    </span>graphs.means<span class="op">$</span>zeMap_dots <span class="op">+</span><span class="st"> </span></span>
<span id="cb5-90"><a href="Functions.html#cb5-90"></a><span class="st">    </span>graphs.means<span class="op">$</span>zeMap_text}</span>
<span id="cb5-91"><a href="Functions.html#cb5-91"></a>  <span class="cf">if</span> (mode <span class="op">==</span><span class="st"> &quot;CI&quot;</span>){</span>
<span id="cb5-92"><a href="Functions.html#cb5-92"></a>    factor.map &lt;-<span class="st"> </span>fs.plot<span class="op">$</span>zeMap_background <span class="op">+</span></span>
<span id="cb5-93"><a href="Functions.html#cb5-93"></a><span class="st">    </span>boot.elli <span class="op">+</span><span class="st"> </span></span>
<span id="cb5-94"><a href="Functions.html#cb5-94"></a><span class="st">    </span>fs.plot<span class="op">$</span>zeMap_dots <span class="op">+</span><span class="st"> </span></span>
<span id="cb5-95"><a href="Functions.html#cb5-95"></a><span class="st">    </span>fs.label <span class="op">+</span><span class="st">  </span></span>
<span id="cb5-96"><a href="Functions.html#cb5-96"></a><span class="st">    </span>graphs.means<span class="op">$</span>zeMap_dots <span class="op">+</span><span class="st"> </span></span>
<span id="cb5-97"><a href="Functions.html#cb5-97"></a><span class="st">    </span>graphs.means<span class="op">$</span>zeMap_text}</span>
<span id="cb5-98"><a href="Functions.html#cb5-98"></a>  factor.map</span>
<span id="cb5-99"><a href="Functions.html#cb5-99"></a>}</span></code></pre></div>
</div>
<div id="CFactorScore" class="section level2">
<h2><span class="header-section-number">2.5</span> Plotting Column Plot</h2>
<p><strong>Required parameters:</strong> fj(column factor scores), eigs(eigenvalue), tau(Kendall rank correlation coefficient), d(dimension, default = 1),
col(color coding of variables), method(title names)</p>
<p><strong>Output:</strong> column factor scores plot.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="Functions.html#cb6-1"></a>plot.cfs &lt;-<span class="st"> </span><span class="cf">function</span>(fj, eigs, </span>
<span id="cb6-2"><a href="Functions.html#cb6-2"></a>                     tau, <span class="dt">d =</span> <span class="dv">1</span>, </span>
<span id="cb6-3"><a href="Functions.html#cb6-3"></a>                     <span class="dt">col =</span> <span class="ot">NULL</span>, </span>
<span id="cb6-4"><a href="Functions.html#cb6-4"></a>                     <span class="dt">method =</span> <span class="st">&quot; &quot;</span>, </span>
<span id="cb6-5"><a href="Functions.html#cb6-5"></a>                     <span class="dt">colrow =</span> <span class="st">&quot;row&quot;</span>)</span>
<span id="cb6-6"><a href="Functions.html#cb6-6"></a>  {</span>
<span id="cb6-7"><a href="Functions.html#cb6-7"></a>  <span class="cf">if</span>(colrow <span class="op">==</span><span class="st"> &quot;row&quot;</span>){</span>
<span id="cb6-8"><a href="Functions.html#cb6-8"></a>    cr &lt;-<span class="st"> </span><span class="kw">nrow</span>(fj)</span>
<span id="cb6-9"><a href="Functions.html#cb6-9"></a>  }</span>
<span id="cb6-10"><a href="Functions.html#cb6-10"></a>  <span class="cf">if</span>(colrow <span class="op">==</span><span class="st"> &quot;col&quot;</span>){</span>
<span id="cb6-11"><a href="Functions.html#cb6-11"></a>    cr &lt;-<span class="st"> </span><span class="kw">ncol</span>(fj)</span>
<span id="cb6-12"><a href="Functions.html#cb6-12"></a>  }</span>
<span id="cb6-13"><a href="Functions.html#cb6-13"></a>  <span class="cf">if</span>(<span class="kw">is.null</span>(col)){</span>
<span id="cb6-14"><a href="Functions.html#cb6-14"></a>    col &lt;-<span class="st"> </span>prettyGraphs<span class="op">::</span><span class="kw">prettyGraphsColorSelection</span>(cr)</span>
<span id="cb6-15"><a href="Functions.html#cb6-15"></a>  }</span>
<span id="cb6-16"><a href="Functions.html#cb6-16"></a>  fj.labels &lt;-<span class="st"> </span><span class="kw">createxyLabels.gen</span>(d,(d<span class="op">+</span><span class="dv">1</span>),</span>
<span id="cb6-17"><a href="Functions.html#cb6-17"></a>                             <span class="dt">lambda =</span> eigs,</span>
<span id="cb6-18"><a href="Functions.html#cb6-18"></a>                             <span class="dt">tau =</span> <span class="kw">round</span>(tau),</span>
<span id="cb6-19"><a href="Functions.html#cb6-19"></a>                             <span class="dt">axisName =</span> <span class="st">&quot;Component &quot;</span></span>
<span id="cb6-20"><a href="Functions.html#cb6-20"></a>                             )</span>
<span id="cb6-21"><a href="Functions.html#cb6-21"></a>  fj.plot &lt;-<span class="st"> </span><span class="kw">createFactorMap</span>(fj, <span class="co"># data</span></span>
<span id="cb6-22"><a href="Functions.html#cb6-22"></a>               <span class="dt">title =</span> <span class="kw">paste0</span>(<span class="st">&quot;Factor Scores&quot;</span>, method),</span>
<span id="cb6-23"><a href="Functions.html#cb6-23"></a>               <span class="dt">axis1 =</span> d, </span>
<span id="cb6-24"><a href="Functions.html#cb6-24"></a>               <span class="dt">axis2 =</span> (d<span class="op">+</span><span class="dv">1</span>), </span>
<span id="cb6-25"><a href="Functions.html#cb6-25"></a>               <span class="dt">pch =</span> <span class="dv">19</span>, </span>
<span id="cb6-26"><a href="Functions.html#cb6-26"></a>               <span class="dt">cex =</span> <span class="dv">2</span>, </span>
<span id="cb6-27"><a href="Functions.html#cb6-27"></a>               <span class="dt">text.cex =</span> <span class="dv">3</span>, </span>
<span id="cb6-28"><a href="Functions.html#cb6-28"></a>               <span class="dt">col.points =</span> col, </span>
<span id="cb6-29"><a href="Functions.html#cb6-29"></a>               <span class="dt">col.labels =</span> col </span>
<span id="cb6-30"><a href="Functions.html#cb6-30"></a>                            )</span>
<span id="cb6-31"><a href="Functions.html#cb6-31"></a>  column.factor.map &lt;-<span class="st"> </span>fj.plot<span class="op">$</span>zeMap_background <span class="op">+</span><span class="st"> </span></span>
<span id="cb6-32"><a href="Functions.html#cb6-32"></a><span class="st">    </span>fj.plot<span class="op">$</span>zeMap_dots <span class="op">+</span><span class="st"> </span></span>
<span id="cb6-33"><a href="Functions.html#cb6-33"></a><span class="st">    </span>fj.plot<span class="op">$</span>zeMap_text <span class="op">+</span><span class="st"> </span></span>
<span id="cb6-34"><a href="Functions.html#cb6-34"></a><span class="st">    </span>fj.labels</span>
<span id="cb6-35"><a href="Functions.html#cb6-35"></a>  column.factor.map</span>
<span id="cb6-36"><a href="Functions.html#cb6-36"></a>}</span></code></pre></div>
</div>
<div id="Loading" class="section level2">
<h2><span class="header-section-number">2.6</span> Plotting Loading Plot</h2>
<p><strong>Required parameters:</strong> data(raw data), col(color coding), fs(factor scores), eigs(eigenvalue), tau(Kendall rank correlation coefficient), d(dimension, default = 1)</p>
<p><strong>Output:</strong> Loading plot for each variable.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="Functions.html#cb7-1"></a>plot.loading &lt;-<span class="st"> </span><span class="cf">function</span>(data, <span class="dt">col=</span><span class="ot">NULL</span>, fs, eigs, tau, <span class="dt">d=</span><span class="dv">1</span>){</span>
<span id="cb7-2"><a href="Functions.html#cb7-2"></a>  <span class="cf">if</span> (<span class="kw">is.null</span>(col)){</span>
<span id="cb7-3"><a href="Functions.html#cb7-3"></a>    col &lt;-<span class="st"> </span><span class="kw">prettyGraphsColorSelection</span>(<span class="dt">n.colors =</span> <span class="kw">ncol</span>(data))</span>
<span id="cb7-4"><a href="Functions.html#cb7-4"></a>  }</span>
<span id="cb7-5"><a href="Functions.html#cb7-5"></a>  cor.loading &lt;-<span class="st"> </span><span class="kw">cor</span>(data, fs)</span>
<span id="cb7-6"><a href="Functions.html#cb7-6"></a>  <span class="kw">rownames</span>(cor.loading) &lt;-<span class="st"> </span><span class="kw">rownames</span>(cor.loading)</span>
<span id="cb7-7"><a href="Functions.html#cb7-7"></a>  fi.labels &lt;-<span class="st"> </span><span class="kw">createxyLabels.gen</span>(d,(d<span class="op">+</span><span class="dv">1</span>),</span>
<span id="cb7-8"><a href="Functions.html#cb7-8"></a>                     <span class="dt">lambda =</span> eigs,</span>
<span id="cb7-9"><a href="Functions.html#cb7-9"></a>                     <span class="dt">tau =</span>  <span class="kw">round</span>(tau),</span>
<span id="cb7-10"><a href="Functions.html#cb7-10"></a>                     <span class="dt">axisName =</span> <span class="st">&quot;Component &quot;</span></span>
<span id="cb7-11"><a href="Functions.html#cb7-11"></a>  )</span>
<span id="cb7-12"><a href="Functions.html#cb7-12"></a>  loading.plot &lt;-<span class="st"> </span><span class="kw">createFactorMap</span>(cor.loading,</span>
<span id="cb7-13"><a href="Functions.html#cb7-13"></a>                     <span class="dt">axis1 =</span> d, </span>
<span id="cb7-14"><a href="Functions.html#cb7-14"></a>                     <span class="dt">axis2 =</span> (d<span class="op">+</span><span class="dv">1</span>),</span>
<span id="cb7-15"><a href="Functions.html#cb7-15"></a>                     <span class="dt">constraints =</span> <span class="kw">list</span>(<span class="dt">minx =</span> <span class="dv">-1</span>, <span class="dt">miny =</span> <span class="dv">-1</span>,</span>
<span id="cb7-16"><a href="Functions.html#cb7-16"></a>                                         <span class="dt">maxx =</span> <span class="dv">1</span>, <span class="dt">maxy =</span> <span class="dv">1</span>),</span>
<span id="cb7-17"><a href="Functions.html#cb7-17"></a>                     <span class="dt">col.points =</span> col,</span>
<span id="cb7-18"><a href="Functions.html#cb7-18"></a>                     <span class="dt">col.labels =</span> col)</span>
<span id="cb7-19"><a href="Functions.html#cb7-19"></a>  LoadingMapWithCircles &lt;-<span class="st">  </span>loading.plot<span class="op">$</span>zeMap_background <span class="op">+</span><span class="st"> </span></span>
<span id="cb7-20"><a href="Functions.html#cb7-20"></a><span class="st">    </span>loading.plot<span class="op">$</span>zeMap_dots <span class="op">+</span></span>
<span id="cb7-21"><a href="Functions.html#cb7-21"></a><span class="st">    </span><span class="kw">addArrows</span>(cor.loading[,d<span class="op">:</span>(d<span class="op">+</span><span class="dv">1</span>)], <span class="dt">color =</span> col) <span class="op">+</span></span>
<span id="cb7-22"><a href="Functions.html#cb7-22"></a><span class="st">    </span><span class="kw">addCircleOfCor</span>() <span class="op">+</span></span>
<span id="cb7-23"><a href="Functions.html#cb7-23"></a><span class="st">    </span>loading.plot<span class="op">$</span>zeMap_text <span class="op">+</span><span class="st">  </span></span>
<span id="cb7-24"><a href="Functions.html#cb7-24"></a><span class="st">    </span>fi.labels</span>
<span id="cb7-25"><a href="Functions.html#cb7-25"></a>  LoadingMapWithCircles</span>
<span id="cb7-26"><a href="Functions.html#cb7-26"></a>}</span></code></pre></div>
</div>
<div id="Contribution" class="section level2">
<h2><span class="header-section-number">2.7</span> Plotting Contribution Barplot</h2>
<p><strong>Required parameters:</strong> cj(contribution of each variable), fj(factor scores of each variable), col(color coding), boot.ratios(bootstrap ratio), signiOnly(choose to only display sigificant contribution or not, default = FALSE), fig(how many plots to display, default = 2)</p>
<p><strong>Output:</strong> Combination of contribution barplots.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="Functions.html#cb8-1"></a>plot.cb &lt;-<span class="st"> </span><span class="cf">function</span>(cj, fj, <span class="dt">col =</span> <span class="ot">NULL</span>, </span>
<span id="cb8-2"><a href="Functions.html#cb8-2"></a>                    boot.ratios, <span class="dt">signifOnly =</span> <span class="ot">FALSE</span>, </span>
<span id="cb8-3"><a href="Functions.html#cb8-3"></a>                    <span class="dt">fig =</span> <span class="dv">2</span>, <span class="dt">horizontal =</span> <span class="ot">FALSE</span>, </span>
<span id="cb8-4"><a href="Functions.html#cb8-4"></a>                    <span class="dt">colrow =</span> <span class="st">&quot;col&quot;</span>, <span class="dt">fontsize =</span> <span class="dv">3</span>)</span>
<span id="cb8-5"><a href="Functions.html#cb8-5"></a>  {</span>
<span id="cb8-6"><a href="Functions.html#cb8-6"></a>  <span class="cf">if</span> (colrow <span class="op">==</span><span class="st"> &quot;col&quot;</span>){</span>
<span id="cb8-7"><a href="Functions.html#cb8-7"></a>    cr &lt;-<span class="st"> </span><span class="kw">ncol</span>(cj)</span>
<span id="cb8-8"><a href="Functions.html#cb8-8"></a>  }</span>
<span id="cb8-9"><a href="Functions.html#cb8-9"></a>  <span class="cf">if</span> (colrow <span class="op">==</span><span class="st"> &quot;row&quot;</span>){</span>
<span id="cb8-10"><a href="Functions.html#cb8-10"></a>    cr &lt;-<span class="st"> </span><span class="kw">nrow</span>(cj)</span>
<span id="cb8-11"><a href="Functions.html#cb8-11"></a>  }</span>
<span id="cb8-12"><a href="Functions.html#cb8-12"></a>  <span class="co"># Contribution Plot</span></span>
<span id="cb8-13"><a href="Functions.html#cb8-13"></a>  <span class="co">### plot contributions for component 1</span></span>
<span id="cb8-14"><a href="Functions.html#cb8-14"></a>  <span class="cf">if</span> (<span class="kw">is.null</span>(col)){</span>
<span id="cb8-15"><a href="Functions.html#cb8-15"></a>      col &lt;-<span class="st"> </span>prettyGraphs<span class="op">::</span><span class="kw">prettyGraphsColorSelection</span>(cr)</span>
<span id="cb8-16"><a href="Functions.html#cb8-16"></a>  }</span>
<span id="cb8-17"><a href="Functions.html#cb8-17"></a>  signed.ctrJ &lt;-<span class="st"> </span>cj <span class="op">*</span><span class="st"> </span><span class="kw">sign</span>(fj)</span>
<span id="cb8-18"><a href="Functions.html#cb8-18"></a>  laDim =<span class="st"> </span><span class="dv">1</span></span>
<span id="cb8-19"><a href="Functions.html#cb8-19"></a>  ctrJ<span class="fl">.1</span> &lt;-<span class="st"> </span><span class="kw">PrettyBarPlot2</span>(signed.ctrJ[,laDim],</span>
<span id="cb8-20"><a href="Functions.html#cb8-20"></a>            <span class="dt">threshold =</span> <span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="kw">NROW</span>(signed.ctrJ),</span>
<span id="cb8-21"><a href="Functions.html#cb8-21"></a>            <span class="dt">font.size =</span> fontsize,</span>
<span id="cb8-22"><a href="Functions.html#cb8-22"></a>            <span class="dt">signifOnly =</span> signifOnly,</span>
<span id="cb8-23"><a href="Functions.html#cb8-23"></a>            <span class="dt">horizontal =</span> horizontal,</span>
<span id="cb8-24"><a href="Functions.html#cb8-24"></a>            <span class="dt">color4bar =</span> col, <span class="co"># we need hex code</span></span>
<span id="cb8-25"><a href="Functions.html#cb8-25"></a>            <span class="dt">main =</span> <span class="st">&#39;Variable Contributions (Signed)&#39;</span>,</span>
<span id="cb8-26"><a href="Functions.html#cb8-26"></a>            <span class="dt">ylab =</span> <span class="kw">paste0</span>(<span class="st">&#39;Contributions Barplot&#39;</span>,</span>
<span id="cb8-27"><a href="Functions.html#cb8-27"></a>                           laDim),</span>
<span id="cb8-28"><a href="Functions.html#cb8-28"></a>            <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="fl">1.2</span><span class="op">*</span><span class="kw">min</span>(signed.ctrJ), </span>
<span id="cb8-29"><a href="Functions.html#cb8-29"></a>            <span class="fl">1.2</span><span class="op">*</span><span class="kw">max</span>(signed.ctrJ))</span>
<span id="cb8-30"><a href="Functions.html#cb8-30"></a>    ) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Contribution&quot;</span>,<span class="dt">subtitle =</span> <span class="kw">paste0</span>(<span class="st">&#39;Component &#39;</span>, laDim))</span>
<span id="cb8-31"><a href="Functions.html#cb8-31"></a>  </span>
<span id="cb8-32"><a href="Functions.html#cb8-32"></a>  <span class="co">### plot contributions for component 2</span></span>
<span id="cb8-33"><a href="Functions.html#cb8-33"></a>  laDim =<span class="dv">2</span></span>
<span id="cb8-34"><a href="Functions.html#cb8-34"></a>  ctrJ<span class="fl">.2</span> &lt;-<span class="st"> </span><span class="kw">PrettyBarPlot2</span>(signed.ctrJ[,laDim],</span>
<span id="cb8-35"><a href="Functions.html#cb8-35"></a>               <span class="dt">threshold =</span> <span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="kw">NROW</span>(signed.ctrJ),</span>
<span id="cb8-36"><a href="Functions.html#cb8-36"></a>               <span class="dt">font.size =</span> fontsize,</span>
<span id="cb8-37"><a href="Functions.html#cb8-37"></a>               <span class="dt">color4bar =</span> col, <span class="co"># we need hex code</span></span>
<span id="cb8-38"><a href="Functions.html#cb8-38"></a>               <span class="dt">signifOnly =</span>signifOnly,</span>
<span id="cb8-39"><a href="Functions.html#cb8-39"></a>               <span class="dt">horizontal =</span> horizontal,</span>
<span id="cb8-40"><a href="Functions.html#cb8-40"></a>               <span class="dt">main =</span> <span class="st">&#39;Variable Contributions (Signed)&#39;</span>,</span>
<span id="cb8-41"><a href="Functions.html#cb8-41"></a>               <span class="dt">ylab =</span> <span class="kw">paste0</span>(<span class="st">&#39;Contributions Barplot&#39;</span>,laDim),</span>
<span id="cb8-42"><a href="Functions.html#cb8-42"></a>               <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="fl">1.2</span><span class="op">*</span><span class="kw">min</span>(signed.ctrJ),<span class="fl">1.2</span><span class="op">*</span><span class="kw">max</span>(signed.ctrJ))</span>
<span id="cb8-43"><a href="Functions.html#cb8-43"></a>  )<span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;&quot;</span>,<span class="dt">subtitle =</span> <span class="kw">paste0</span>(<span class="st">&#39;Component &#39;</span>, laDim))</span>
<span id="cb8-44"><a href="Functions.html#cb8-44"></a>  laDim =<span class="dv">3</span></span>
<span id="cb8-45"><a href="Functions.html#cb8-45"></a>  ctrJ<span class="fl">.3</span> &lt;-<span class="st"> </span><span class="kw">PrettyBarPlot2</span>(signed.ctrJ[,laDim],</span>
<span id="cb8-46"><a href="Functions.html#cb8-46"></a>                  <span class="dt">threshold =</span> <span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="kw">NROW</span>(signed.ctrJ),</span>
<span id="cb8-47"><a href="Functions.html#cb8-47"></a>                  <span class="dt">font.size =</span> fontsize,</span>
<span id="cb8-48"><a href="Functions.html#cb8-48"></a>                  <span class="dt">color4bar =</span> col, <span class="co"># we need hex code</span></span>
<span id="cb8-49"><a href="Functions.html#cb8-49"></a>                  <span class="dt">signifOnly =</span> signifOnly,                             </span>
<span id="cb8-50"><a href="Functions.html#cb8-50"></a>                  <span class="dt">horizontal =</span> horizontal,</span>
<span id="cb8-51"><a href="Functions.html#cb8-51"></a>                  <span class="dt">main =</span> <span class="st">&#39;Variable Contributions (Signed)&#39;</span>,</span>
<span id="cb8-52"><a href="Functions.html#cb8-52"></a>                  <span class="dt">ylab =</span> <span class="kw">paste0</span>(<span class="st">&#39;Contributions Barplot&#39;</span>,laDim),</span>
<span id="cb8-53"><a href="Functions.html#cb8-53"></a>                  <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="fl">1.2</span><span class="op">*</span><span class="kw">min</span>(signed.ctrJ), </span>
<span id="cb8-54"><a href="Functions.html#cb8-54"></a>                                    <span class="fl">1.2</span><span class="op">*</span><span class="kw">max</span>(signed.ctrJ))</span>
<span id="cb8-55"><a href="Functions.html#cb8-55"></a>  )<span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;&quot;</span>,<span class="dt">subtitle =</span> <span class="kw">paste0</span>(<span class="st">&#39;Component &#39;</span>, laDim))</span>
<span id="cb8-56"><a href="Functions.html#cb8-56"></a>  </span>
<span id="cb8-57"><a href="Functions.html#cb8-57"></a></span>
<span id="cb8-58"><a href="Functions.html#cb8-58"></a>  </span>
<span id="cb8-59"><a href="Functions.html#cb8-59"></a>  <span class="co">### Bootstrap of columns vectors</span></span>
<span id="cb8-60"><a href="Functions.html#cb8-60"></a>  BR &lt;-<span class="st"> </span>boot.ratios</span>
<span id="cb8-61"><a href="Functions.html#cb8-61"></a>  laDim =<span class="st"> </span><span class="dv">1</span></span>
<span id="cb8-62"><a href="Functions.html#cb8-62"></a>  </span>
<span id="cb8-63"><a href="Functions.html#cb8-63"></a>  <span class="co"># Plot the bootstrap ratios for Dimension 1</span></span>
<span id="cb8-64"><a href="Functions.html#cb8-64"></a>  ba001.BR1 &lt;-<span class="st"> </span><span class="kw">PrettyBarPlot2</span>(BR[,laDim],</span>
<span id="cb8-65"><a href="Functions.html#cb8-65"></a>                 <span class="dt">threshold =</span> <span class="dv">2</span>,</span>
<span id="cb8-66"><a href="Functions.html#cb8-66"></a>                 <span class="dt">font.size =</span> fontsize,</span>
<span id="cb8-67"><a href="Functions.html#cb8-67"></a>                 <span class="dt">signifOnly =</span> signifOnly,</span>
<span id="cb8-68"><a href="Functions.html#cb8-68"></a>                 <span class="dt">horizontal =</span> horizontal,</span>
<span id="cb8-69"><a href="Functions.html#cb8-69"></a>                 <span class="dt">color4bar =</span> col, <span class="co"># we need hex code</span></span>
<span id="cb8-70"><a href="Functions.html#cb8-70"></a>                 <span class="dt">ylab =</span> <span class="st">&#39;Bootstrap ratios&#39;</span>,</span>
<span id="cb8-71"><a href="Functions.html#cb8-71"></a>                 <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="fl">1.2</span><span class="op">*</span><span class="kw">min</span>(BR[,laDim]), </span>
<span id="cb8-72"><a href="Functions.html#cb8-72"></a>                                       <span class="fl">1.2</span><span class="op">*</span><span class="kw">max</span>(BR[,laDim]))</span>
<span id="cb8-73"><a href="Functions.html#cb8-73"></a>  ) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Bootstrap ratios&quot;</span>, </span>
<span id="cb8-74"><a href="Functions.html#cb8-74"></a>              <span class="dt">subtitle =</span> <span class="kw">paste0</span>(<span class="st">&#39;Component &#39;</span>, laDim))</span>
<span id="cb8-75"><a href="Functions.html#cb8-75"></a>  </span>
<span id="cb8-76"><a href="Functions.html#cb8-76"></a>  <span class="co"># Plot the bootstrap ratios for Dimension 2</span></span>
<span id="cb8-77"><a href="Functions.html#cb8-77"></a>  laDim =<span class="st"> </span><span class="dv">2</span></span>
<span id="cb8-78"><a href="Functions.html#cb8-78"></a>  ba002.BR2 &lt;-<span class="st"> </span><span class="kw">PrettyBarPlot2</span>(BR[,laDim],</span>
<span id="cb8-79"><a href="Functions.html#cb8-79"></a>                 <span class="dt">threshold =</span> <span class="dv">2</span>,</span>
<span id="cb8-80"><a href="Functions.html#cb8-80"></a>                 <span class="dt">font.size =</span> fontsize,</span>
<span id="cb8-81"><a href="Functions.html#cb8-81"></a>                 <span class="dt">signifOnly =</span> signifOnly,                             </span>
<span id="cb8-82"><a href="Functions.html#cb8-82"></a>                 <span class="dt">horizontal =</span> horizontal,</span>
<span id="cb8-83"><a href="Functions.html#cb8-83"></a>                 <span class="dt">color4bar =</span> col, <span class="co"># we need hex code</span></span>
<span id="cb8-84"><a href="Functions.html#cb8-84"></a>                 <span class="dt">ylab =</span> <span class="st">&#39;Bootstrap ratios&#39;</span>,</span>
<span id="cb8-85"><a href="Functions.html#cb8-85"></a>                 <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="fl">1.2</span><span class="op">*</span><span class="kw">min</span>(BR[,laDim]), </span>
<span id="cb8-86"><a href="Functions.html#cb8-86"></a>                          <span class="fl">1.2</span><span class="op">*</span><span class="kw">max</span>(BR[,laDim]))</span>
<span id="cb8-87"><a href="Functions.html#cb8-87"></a>  ) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;&quot;</span>,<span class="dt">subtitle =</span> <span class="kw">paste0</span>(<span class="st">&#39;Component &#39;</span>, laDim))</span>
<span id="cb8-88"><a href="Functions.html#cb8-88"></a>  </span>
<span id="cb8-89"><a href="Functions.html#cb8-89"></a>  laDim =<span class="st"> </span><span class="dv">3</span></span>
<span id="cb8-90"><a href="Functions.html#cb8-90"></a>  ba003.BR3 &lt;-<span class="st"> </span><span class="kw">PrettyBarPlot2</span>(BR[,laDim],</span>
<span id="cb8-91"><a href="Functions.html#cb8-91"></a>                              <span class="dt">threshold =</span> <span class="dv">2</span>,</span>
<span id="cb8-92"><a href="Functions.html#cb8-92"></a>                              <span class="dt">font.size =</span> fontsize,</span>
<span id="cb8-93"><a href="Functions.html#cb8-93"></a>                              <span class="dt">signifOnly =</span> signifOnly,                             </span>
<span id="cb8-94"><a href="Functions.html#cb8-94"></a>                              <span class="dt">horizontal =</span> horizontal,</span>
<span id="cb8-95"><a href="Functions.html#cb8-95"></a>                              <span class="dt">color4bar =</span> col,</span>
<span id="cb8-96"><a href="Functions.html#cb8-96"></a>                              <span class="dt">ylab =</span> <span class="st">&#39;Bootstrap ratios&#39;</span>,</span>
<span id="cb8-97"><a href="Functions.html#cb8-97"></a>                              <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="fl">1.2</span><span class="op">*</span><span class="kw">min</span>(BR[,laDim]), </span>
<span id="cb8-98"><a href="Functions.html#cb8-98"></a>                                       <span class="fl">1.2</span><span class="op">*</span><span class="kw">max</span>(BR[,laDim]))</span>
<span id="cb8-99"><a href="Functions.html#cb8-99"></a>  ) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;&quot;</span>,<span class="dt">subtitle =</span> <span class="kw">paste0</span>(<span class="st">&#39;Component &#39;</span>, laDim))</span>
<span id="cb8-100"><a href="Functions.html#cb8-100"></a>  </span>
<span id="cb8-101"><a href="Functions.html#cb8-101"></a>  <span class="cf">if</span>(fig <span class="op">==</span><span class="st"> </span><span class="dv">2</span>){</span>
<span id="cb8-102"><a href="Functions.html#cb8-102"></a>    <span class="kw">grid.arrange</span>(</span>
<span id="cb8-103"><a href="Functions.html#cb8-103"></a>    <span class="kw">as.grob</span>(ctrJ<span class="fl">.1</span>),</span>
<span id="cb8-104"><a href="Functions.html#cb8-104"></a>    <span class="kw">as.grob</span>(ctrJ<span class="fl">.2</span>),</span>
<span id="cb8-105"><a href="Functions.html#cb8-105"></a>    <span class="kw">as.grob</span>(ba001.BR1),</span>
<span id="cb8-106"><a href="Functions.html#cb8-106"></a>    <span class="kw">as.grob</span>(ba002.BR2),</span>
<span id="cb8-107"><a href="Functions.html#cb8-107"></a>    <span class="dt">ncol =</span> <span class="dv">2</span>,<span class="dt">nrow =</span> <span class="dv">2</span>,</span>
<span id="cb8-108"><a href="Functions.html#cb8-108"></a>    <span class="dt">top =</span> <span class="kw">textGrob</span>(<span class="st">&quot;Barplots for variables&quot;</span>, </span>
<span id="cb8-109"><a href="Functions.html#cb8-109"></a>                   <span class="dt">gp =</span> <span class="kw">gpar</span>(<span class="dt">fontsize =</span> <span class="dv">18</span>, <span class="dt">font =</span> <span class="dv">3</span>))</span>
<span id="cb8-110"><a href="Functions.html#cb8-110"></a>  )</span>
<span id="cb8-111"><a href="Functions.html#cb8-111"></a>  }</span>
<span id="cb8-112"><a href="Functions.html#cb8-112"></a>  <span class="cf">if</span>(fig<span class="op">==</span><span class="dv">3</span>){</span>
<span id="cb8-113"><a href="Functions.html#cb8-113"></a>    <span class="kw">grid.arrange</span>(</span>
<span id="cb8-114"><a href="Functions.html#cb8-114"></a>    <span class="kw">as.grob</span>(ctrJ<span class="fl">.1</span>),</span>
<span id="cb8-115"><a href="Functions.html#cb8-115"></a>    <span class="kw">as.grob</span>(ctrJ<span class="fl">.2</span>),</span>
<span id="cb8-116"><a href="Functions.html#cb8-116"></a>    <span class="kw">as.grob</span>(ctrJ<span class="fl">.3</span>),</span>
<span id="cb8-117"><a href="Functions.html#cb8-117"></a>    <span class="kw">as.grob</span>(ba001.BR1),</span>
<span id="cb8-118"><a href="Functions.html#cb8-118"></a>    <span class="kw">as.grob</span>(ba002.BR2),</span>
<span id="cb8-119"><a href="Functions.html#cb8-119"></a>    <span class="kw">as.grob</span>(ba003.BR3),</span>
<span id="cb8-120"><a href="Functions.html#cb8-120"></a>    <span class="dt">ncol =</span> <span class="dv">2</span>,<span class="dt">nrow =</span> <span class="dv">3</span>,</span>
<span id="cb8-121"><a href="Functions.html#cb8-121"></a>    <span class="dt">top =</span> <span class="kw">textGrob</span>(<span class="st">&quot;Barplots for variables&quot;</span>, </span>
<span id="cb8-122"><a href="Functions.html#cb8-122"></a>                   <span class="dt">gp =</span> <span class="kw">gpar</span>(<span class="dt">fontsize =</span> <span class="dv">18</span>, <span class="dt">font =</span> <span class="dv">3</span>))</span>
<span id="cb8-123"><a href="Functions.html#cb8-123"></a>  )</span>
<span id="cb8-124"><a href="Functions.html#cb8-124"></a>  }</span>
<span id="cb8-125"><a href="Functions.html#cb8-125"></a>}</span></code></pre></div>
</div>
<div id="binshelper" class="section level2">
<h2><span class="header-section-number">2.8</span> Bins Helper Functions</h2>
<p><strong>Required parameters:</strong> quantitative data</p>
<p><strong>Output:</strong> qualitative data with trisection</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="Functions.html#cb9-1"></a>bins_helper &lt;-<span class="st"> </span><span class="cf">function</span>(DATA, <span class="dt">name =</span> <span class="st">&quot;Variable&quot;</span>) {</span>
<span id="cb9-2"><a href="Functions.html#cb9-2"></a>  data &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(DATA)</span>
<span id="cb9-3"><a href="Functions.html#cb9-3"></a>  tp &lt;-<span class="st"> </span><span class="kw">quantile</span>(<span class="kw">as.numeric</span>(data<span class="op">$</span>DATA),<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span><span class="op">/</span><span class="dv">3</span>))</span>
<span id="cb9-4"><a href="Functions.html#cb9-4"></a>  ac =<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">table</span>(data))</span>
<span id="cb9-5"><a href="Functions.html#cb9-5"></a>  <span class="cf">if</span> (tp[<span class="dv">3</span>] <span class="op">&lt;</span><span class="st"> </span>tp[<span class="dv">4</span>]){</span>
<span id="cb9-6"><a href="Functions.html#cb9-6"></a>    <span class="cf">if</span> (ac[<span class="dv">1</span>,<span class="st">&quot;Freq&quot;</span>] <span class="op">&gt;</span><span class="st"> </span><span class="dv">3</span>){low &lt;-<span class="st"> </span><span class="kw">which</span>(data<span class="op">&lt;</span><span class="st"> </span>tp[<span class="dv">2</span>])</span>
<span id="cb9-7"><a href="Functions.html#cb9-7"></a>    high &lt;-<span class="st"> </span><span class="kw">which</span>(data <span class="op">&gt;</span><span class="st"> </span>tp[<span class="dv">3</span>])</span>
<span id="cb9-8"><a href="Functions.html#cb9-8"></a>    medium &lt;-<span class="st"> </span><span class="kw">which</span>(data  <span class="op">&gt;=</span><span class="st"> </span>tp[<span class="dv">2</span>] <span class="op">&amp;</span><span class="st"> </span>data <span class="op">&lt;=</span>tp[<span class="dv">3</span>])</span>
<span id="cb9-9"><a href="Functions.html#cb9-9"></a>    data[low,] &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb9-10"><a href="Functions.html#cb9-10"></a>    data[medium,] &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb9-11"><a href="Functions.html#cb9-11"></a>    data[high,] &lt;-<span class="dv">2</span></span>
<span id="cb9-12"><a href="Functions.html#cb9-12"></a>    }<span class="cf">else</span>{ low &lt;-<span class="st"> </span><span class="kw">which</span>(data <span class="op">&lt;=</span><span class="st"> </span>tp[<span class="dv">2</span>])</span>
<span id="cb9-13"><a href="Functions.html#cb9-13"></a>      high &lt;-<span class="st"> </span><span class="kw">which</span>(data <span class="op">&gt;</span><span class="st"> </span>tp[<span class="dv">3</span>])</span>
<span id="cb9-14"><a href="Functions.html#cb9-14"></a>      medium &lt;-<span class="st"> </span><span class="kw">which</span>(data <span class="op">&gt;</span><span class="st"> </span>tp[<span class="dv">2</span>] <span class="op">&amp;</span><span class="st"> </span>data <span class="op">&lt;=</span>tp[<span class="dv">3</span>])</span>
<span id="cb9-15"><a href="Functions.html#cb9-15"></a>      data[low,] &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb9-16"><a href="Functions.html#cb9-16"></a>      data[medium,] &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb9-17"><a href="Functions.html#cb9-17"></a>      data[high,] &lt;-<span class="dv">2</span>}</span>
<span id="cb9-18"><a href="Functions.html#cb9-18"></a>  }<span class="cf">else</span>{low &lt;-<span class="kw">which</span>(data <span class="op">&lt;</span><span class="st"> </span>tp[<span class="dv">2</span>])</span>
<span id="cb9-19"><a href="Functions.html#cb9-19"></a>    high &lt;-<span class="st"> </span><span class="kw">which</span>(data <span class="op">&gt;=</span><span class="st"> </span>tp[<span class="dv">3</span>])</span>
<span id="cb9-20"><a href="Functions.html#cb9-20"></a>    medium &lt;-<span class="st"> </span><span class="kw">which</span>(data <span class="op">&gt;=</span><span class="st"> </span>tp[<span class="dv">2</span>] <span class="op">&amp;</span><span class="st"> </span>data <span class="op">&lt;</span>tp[<span class="dv">3</span>]) </span>
<span id="cb9-21"><a href="Functions.html#cb9-21"></a>    data[low,] &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb9-22"><a href="Functions.html#cb9-22"></a>    data[medium,] &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb9-23"><a href="Functions.html#cb9-23"></a>    data[high,] &lt;-<span class="dv">2</span>}</span>
<span id="cb9-24"><a href="Functions.html#cb9-24"></a>  a.c =<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">table</span>(data))</span>
<span id="cb9-25"><a href="Functions.html#cb9-25"></a>  <span class="kw">colnames</span>(a.c) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Value&quot;</span>,<span class="st">&quot;Freq&quot;</span>)</span>
<span id="cb9-26"><a href="Functions.html#cb9-26"></a>  <span class="kw">rownames</span>(a.c) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Level_1&quot;</span>, <span class="st">&quot;Level_2&quot;</span>, <span class="st">&quot;Level_3&quot;</span>)</span>
<span id="cb9-27"><a href="Functions.html#cb9-27"></a>  <span class="co">#print(a.c)</span></span>
<span id="cb9-28"><a href="Functions.html#cb9-28"></a>  spearman.col.score &lt;-<span class="st"> </span><span class="kw">cor</span>(DATA, <span class="kw">as.numeric</span>(data<span class="op">$</span>DATA), </span>
<span id="cb9-29"><a href="Functions.html#cb9-29"></a>                            <span class="dt">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb9-30"><a href="Functions.html#cb9-30"></a>  <span class="kw">cat</span>(name, <span class="st">&quot;spearman r:&quot;</span>, spearman.col.score, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb9-31"><a href="Functions.html#cb9-31"></a>  <span class="kw">return</span>(data)</span>
<span id="cb9-32"><a href="Functions.html#cb9-32"></a>}</span></code></pre></div>
</div>
<div id="plotting-latent-variable-plot" class="section level2">
<h2><span class="header-section-number">2.9</span> Plotting Latent Variable Plot</h2>
<p><strong>Required parameters:</strong> DESIGN, lx(from PLS), ly(from PLS), dimension(default = 1)</p>
<p><strong>Output:</strong> LV plot</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="Functions.html#cb10-1"></a>plot.lv &lt;-<span class="st"> </span><span class="cf">function</span>(DESIGN, lx, ly, <span class="dt">d=</span><span class="dv">1</span> ){</span>
<span id="cb10-2"><a href="Functions.html#cb10-2"></a>  color.dot &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(DESIGN)</span>
<span id="cb10-3"><a href="Functions.html#cb10-3"></a>  na.de &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">levels</span>(DESIGN))</span>
<span id="cb10-4"><a href="Functions.html#cb10-4"></a>  num.de &lt;-<span class="st"> </span><span class="kw">length</span>(na.de)</span>
<span id="cb10-5"><a href="Functions.html#cb10-5"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="st"> </span>num.de){</span>
<span id="cb10-6"><a href="Functions.html#cb10-6"></a>    color.dot[<span class="kw">which</span>(color.dot <span class="op">==</span><span class="st"> </span>na.de[i])] &lt;-<span class="st"> </span>index[i]</span>
<span id="cb10-7"><a href="Functions.html#cb10-7"></a>  }</span>
<span id="cb10-8"><a href="Functions.html#cb10-8"></a>  color.dot &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(color.dot)</span>
<span id="cb10-9"><a href="Functions.html#cb10-9"></a>  <span class="kw">rownames</span>(color.dot) &lt;-<span class="st"> </span>DESIGN</span>
<span id="cb10-10"><a href="Functions.html#cb10-10"></a>  latvar &lt;-<span class="st"> </span><span class="kw">cbind</span>(lx[,d],ly[,d])</span>
<span id="cb10-11"><a href="Functions.html#cb10-11"></a>  <span class="kw">colnames</span>(latvar) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">paste0</span>(<span class="st">&quot;Lx &quot;</span>, d), </span>
<span id="cb10-12"><a href="Functions.html#cb10-12"></a>                        <span class="kw">paste0</span>(<span class="st">&quot;Ly &quot;</span>, d))</span>
<span id="cb10-13"><a href="Functions.html#cb10-13"></a>  </span>
<span id="cb10-14"><a href="Functions.html#cb10-14"></a>  <span class="co"># compute means</span></span>
<span id="cb10-15"><a href="Functions.html#cb10-15"></a>  lv.group &lt;-<span class="st"> </span><span class="kw">getMeans</span>(latvar,DESIGN)</span>
<span id="cb10-16"><a href="Functions.html#cb10-16"></a>  </span>
<span id="cb10-17"><a href="Functions.html#cb10-17"></a>  <span class="co"># get bootstrap intervals of groups</span></span>
<span id="cb10-18"><a href="Functions.html#cb10-18"></a>  lv.group.boot &lt;-<span class="st"> </span><span class="kw">Boot4Mean</span>(latvar, DESIGN)</span>
<span id="cb10-19"><a href="Functions.html#cb10-19"></a>  <span class="kw">colnames</span>(lv.group.boot<span class="op">$</span>BootCube) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">paste0</span>(<span class="st">&quot;Lx &quot;</span>, d), </span>
<span id="cb10-20"><a href="Functions.html#cb10-20"></a>                                        <span class="kw">paste0</span>(<span class="st">&quot;Ly &quot;</span>, d))</span>
<span id="cb10-21"><a href="Functions.html#cb10-21"></a>  </span>
<span id="cb10-22"><a href="Functions.html#cb10-22"></a>  </span>
<span id="cb10-23"><a href="Functions.html#cb10-23"></a>  plot.lv &lt;-<span class="st"> </span><span class="kw">createFactorMap</span>(latvar,</span>
<span id="cb10-24"><a href="Functions.html#cb10-24"></a>             <span class="dt">col.points =</span> color.dot,</span>
<span id="cb10-25"><a href="Functions.html#cb10-25"></a>             <span class="dt">col.labels =</span> color.dot,</span>
<span id="cb10-26"><a href="Functions.html#cb10-26"></a>             <span class="dt">title =</span> <span class="kw">c</span>(<span class="st">&quot;Latent Variable Map&quot;</span>, d),</span>
<span id="cb10-27"><a href="Functions.html#cb10-27"></a>                       <span class="dt">alpha.points =</span> <span class="fl">0.2</span></span>
<span id="cb10-28"><a href="Functions.html#cb10-28"></a>  )</span>
<span id="cb10-29"><a href="Functions.html#cb10-29"></a>  ind &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span>num.de)</span>
<span id="cb10-30"><a href="Functions.html#cb10-30"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>num.de){</span>
<span id="cb10-31"><a href="Functions.html#cb10-31"></a>    inde &lt;-<span class="st"> </span><span class="kw">match</span>(<span class="kw">rownames</span>(color.dot), </span>
<span id="cb10-32"><a href="Functions.html#cb10-32"></a>                  <span class="kw">sort</span>(<span class="kw">rownames</span>(lv.group)))</span>
<span id="cb10-33"><a href="Functions.html#cb10-33"></a>    ind[i] &lt;-<span class="st"> </span><span class="kw">which</span>(inde <span class="op">==</span><span class="st"> </span>i)[<span class="dv">1</span>]</span>
<span id="cb10-34"><a href="Functions.html#cb10-34"></a>  }</span>
<span id="cb10-35"><a href="Functions.html#cb10-35"></a>  grp.ind &lt;-<span class="st"> </span>ind</span>
<span id="cb10-36"><a href="Functions.html#cb10-36"></a>  plot.mean &lt;-<span class="st"> </span><span class="kw">createFactorMap</span>(lv.group,</span>
<span id="cb10-37"><a href="Functions.html#cb10-37"></a>             <span class="dt">col.points =</span> color.dot[grp.ind],</span>
<span id="cb10-38"><a href="Functions.html#cb10-38"></a>             <span class="dt">col.labels =</span> color.dot[grp.ind],</span>
<span id="cb10-39"><a href="Functions.html#cb10-39"></a>             <span class="dt">cex =</span> <span class="dv">4</span>,</span>
<span id="cb10-40"><a href="Functions.html#cb10-40"></a>             <span class="dt">pch =</span> <span class="dv">17</span>,</span>
<span id="cb10-41"><a href="Functions.html#cb10-41"></a>             <span class="dt">alpha.points =</span> <span class="fl">0.8</span>)</span>
<span id="cb10-42"><a href="Functions.html#cb10-42"></a>  </span>
<span id="cb10-43"><a href="Functions.html#cb10-43"></a>  plot.meanCI &lt;-<span class="st"> </span><span class="kw">MakeCIEllipses</span>(lv.group.boot<span class="op">$</span>BootCube[,<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>),], </span>
<span id="cb10-44"><a href="Functions.html#cb10-44"></a>                     <span class="dt">col =</span> color.dot[grp.ind],</span>
<span id="cb10-45"><a href="Functions.html#cb10-45"></a>                     <span class="dt">names.of.factors =</span> <span class="kw">c</span>(<span class="kw">paste0</span>(<span class="st">&quot;Lx &quot;</span>, d), </span>
<span id="cb10-46"><a href="Functions.html#cb10-46"></a>                                          <span class="kw">paste0</span>(<span class="st">&quot;Ly &quot;</span>, d)))</span>
<span id="cb10-47"><a href="Functions.html#cb10-47"></a>  </span>
<span id="cb10-48"><a href="Functions.html#cb10-48"></a>  plot.lv.pls &lt;-<span class="st"> </span>plot.lv<span class="op">$</span>zeMap_background <span class="op">+</span><span class="st"> </span></span>
<span id="cb10-49"><a href="Functions.html#cb10-49"></a><span class="st">    </span>plot.meanCI <span class="op">+</span><span class="st"> </span></span>
<span id="cb10-50"><a href="Functions.html#cb10-50"></a><span class="st">    </span>plot.lv<span class="op">$</span>zeMap_dots <span class="op">+</span><span class="st"> </span></span>
<span id="cb10-51"><a href="Functions.html#cb10-51"></a><span class="st">    </span>plot.mean<span class="op">$</span>zeMap_dots <span class="op">+</span><span class="st"> </span></span>
<span id="cb10-52"><a href="Functions.html#cb10-52"></a><span class="st">    </span>plot.mean<span class="op">$</span>zeMap_text</span>
<span id="cb10-53"><a href="Functions.html#cb10-53"></a></span>
<span id="cb10-54"><a href="Functions.html#cb10-54"></a>  plot.lv.pls</span>
<span id="cb10-55"><a href="Functions.html#cb10-55"></a>}</span></code></pre></div>
</div>
<div id="plotting-partial-factor-scores" class="section level2">
<h2><span class="header-section-number">2.10</span> Plotting Partial Factor Scores</h2>
<p><strong>Required parameters:</strong> DESIGN, fs(factor scores), eigs(eigenvalue), tau(explained variance), dimension(default = 1), partial.fi.array(partial matrix), mm(how many sub data sets)</p>
<p><strong>Output:</strong> Partial Factor Scores Map</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="Functions.html#cb11-1"></a>plot.partial.fs &lt;-<span class="st"> </span><span class="cf">function</span>(DESIGN, fs, </span>
<span id="cb11-2"><a href="Functions.html#cb11-2"></a>                            eigs, tau, </span>
<span id="cb11-3"><a href="Functions.html#cb11-3"></a>                            d, partial.fi.array, mm ){</span>
<span id="cb11-4"><a href="Functions.html#cb11-4"></a>  <span class="co"># get some colors</span></span>
<span id="cb11-5"><a href="Functions.html#cb11-5"></a>  color.dot &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(DESIGN)</span>
<span id="cb11-6"><a href="Functions.html#cb11-6"></a>  na.de &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">levels</span>(DESIGN))</span>
<span id="cb11-7"><a href="Functions.html#cb11-7"></a>  num.de &lt;-<span class="st"> </span><span class="kw">length</span>(na.de)</span>
<span id="cb11-8"><a href="Functions.html#cb11-8"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="st"> </span>num.de){</span>
<span id="cb11-9"><a href="Functions.html#cb11-9"></a>    color.dot[<span class="kw">which</span>(color.dot <span class="op">==</span><span class="st"> </span>na.de[i])] &lt;-<span class="st"> </span>index[i]</span>
<span id="cb11-10"><a href="Functions.html#cb11-10"></a>  }</span>
<span id="cb11-11"><a href="Functions.html#cb11-11"></a>  color.dot &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(color.dot)</span>
<span id="cb11-12"><a href="Functions.html#cb11-12"></a>  <span class="kw">rownames</span>(color.dot) &lt;-<span class="st"> </span>DESIGN</span>
<span id="cb11-13"><a href="Functions.html#cb11-13"></a></span>
<span id="cb11-14"><a href="Functions.html#cb11-14"></a>  <span class="co"># Factor Map</span></span>
<span id="cb11-15"><a href="Functions.html#cb11-15"></a>  factor.graph.out &lt;-<span class="st"> </span><span class="kw">createFactorMap</span>(</span>
<span id="cb11-16"><a href="Functions.html#cb11-16"></a>    <span class="dt">X =</span> fs,</span>
<span id="cb11-17"><a href="Functions.html#cb11-17"></a>    <span class="dt">axis =</span> d, <span class="dt">axis2 =</span> (d<span class="op">+</span><span class="dv">1</span>),</span>
<span id="cb11-18"><a href="Functions.html#cb11-18"></a>    <span class="dt">col.points =</span> color.dot,</span>
<span id="cb11-19"><a href="Functions.html#cb11-19"></a>    <span class="dt">col.labels =</span> color.dot,</span>
<span id="cb11-20"><a href="Functions.html#cb11-20"></a>    <span class="dt">title =</span> <span class="st">&quot;MFA_Partial_Factor_Map&quot;</span>,</span>
<span id="cb11-21"><a href="Functions.html#cb11-21"></a>    <span class="dt">display.labels =</span> <span class="ot">FALSE</span>,</span>
<span id="cb11-22"><a href="Functions.html#cb11-22"></a>    <span class="dt">alpha.points =</span> <span class="fl">0.3</span>,</span>
<span id="cb11-23"><a href="Functions.html#cb11-23"></a>    <span class="dt">alpha.labels =</span> <span class="fl">0.3</span></span>
<span id="cb11-24"><a href="Functions.html#cb11-24"></a>  )</span>
<span id="cb11-25"><a href="Functions.html#cb11-25"></a>  <span class="co"># Labels of Factor Map</span></span>
<span id="cb11-26"><a href="Functions.html#cb11-26"></a>  labels4RV &lt;-<span class="st"> </span><span class="kw">createxyLabels.gen</span>(d, (d<span class="op">+</span><span class="dv">1</span>),</span>
<span id="cb11-27"><a href="Functions.html#cb11-27"></a>    <span class="dt">lambda =</span> eigs,</span>
<span id="cb11-28"><a href="Functions.html#cb11-28"></a>    <span class="dt">tau =</span> tau,</span>
<span id="cb11-29"><a href="Functions.html#cb11-29"></a>    <span class="dt">axisName =</span> <span class="st">&quot;Dimension &quot;</span></span>
<span id="cb11-30"><a href="Functions.html#cb11-30"></a>  )</span>
<span id="cb11-31"><a href="Functions.html#cb11-31"></a>  <span class="co"># Groups</span></span>
<span id="cb11-32"><a href="Functions.html#cb11-32"></a>  fm.tmp &lt;-<span class="st"> </span><span class="kw">aggregate</span>(fs, <span class="kw">list</span>(DESIGN), mean)</span>
<span id="cb11-33"><a href="Functions.html#cb11-33"></a>  fm &lt;-<span class="st"> </span>fm.tmp[,<span class="dv">2</span><span class="op">:</span><span class="kw">ncol</span>(fm.tmp)]</span>
<span id="cb11-34"><a href="Functions.html#cb11-34"></a>  <span class="kw">rownames</span>(fm) &lt;-<span class="st"> </span>fm.tmp[,<span class="dv">1</span>]</span>
<span id="cb11-35"><a href="Functions.html#cb11-35"></a>  ind &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span>num.de)</span>
<span id="cb11-36"><a href="Functions.html#cb11-36"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>num.de){</span>
<span id="cb11-37"><a href="Functions.html#cb11-37"></a>    inde &lt;-<span class="st"> </span><span class="kw">match</span>(<span class="kw">rownames</span>(color.dot), <span class="kw">sort</span>(<span class="kw">rownames</span>(fm)))</span>
<span id="cb11-38"><a href="Functions.html#cb11-38"></a>    ind[i] &lt;-<span class="st"> </span><span class="kw">which</span>(inde <span class="op">==</span><span class="st"> </span>i)[<span class="dv">1</span>]</span>
<span id="cb11-39"><a href="Functions.html#cb11-39"></a>  }</span>
<span id="cb11-40"><a href="Functions.html#cb11-40"></a>  grp.ind &lt;-<span class="st"> </span>ind</span>
<span id="cb11-41"><a href="Functions.html#cb11-41"></a>  <span class="kw">rownames</span>(fm[<span class="kw">sort</span>(<span class="kw">rownames</span>(fm)),]) &lt;-<span class="st"> </span><span class="kw">sub</span>(<span class="st">&quot;[[:punct:]]&quot;</span>,<span class="st">&quot;&quot;</span>,</span>
<span id="cb11-42"><a href="Functions.html#cb11-42"></a>                      <span class="kw">rownames</span>(fm[<span class="kw">sort</span>(<span class="kw">rownames</span>(fm)),]))</span>
<span id="cb11-43"><a href="Functions.html#cb11-43"></a>  </span>
<span id="cb11-44"><a href="Functions.html#cb11-44"></a>  MapGroup &lt;-<span class="st"> </span>PTCA4CATA<span class="op">::</span><span class="kw">createFactorMap</span>(fm[<span class="kw">sort</span>(<span class="kw">rownames</span>(fm)),],</span>
<span id="cb11-45"><a href="Functions.html#cb11-45"></a>                            <span class="dt">axis1 =</span> d,</span>
<span id="cb11-46"><a href="Functions.html#cb11-46"></a>                            <span class="dt">axis2 =</span> (d<span class="op">+</span><span class="dv">1</span>),</span>
<span id="cb11-47"><a href="Functions.html#cb11-47"></a>                            <span class="dt">constraints =</span> factor.graph.out<span class="op">$</span>constraints,</span>
<span id="cb11-48"><a href="Functions.html#cb11-48"></a>                            <span class="dt">col.points =</span> color.dot[grp.ind],</span>
<span id="cb11-49"><a href="Functions.html#cb11-49"></a>                            <span class="dt">cex =</span> <span class="dv">4</span>,  <span class="co"># size of the dot (bigger)</span></span>
<span id="cb11-50"><a href="Functions.html#cb11-50"></a>                            <span class="dt">col.labels =</span> color.dot[grp.ind],</span>
<span id="cb11-51"><a href="Functions.html#cb11-51"></a>                            <span class="dt">text.cex =</span> <span class="dv">4</span>,</span>
<span id="cb11-52"><a href="Functions.html#cb11-52"></a>                            <span class="dt">alpha.points =</span> <span class="fl">0.5</span>)</span>
<span id="cb11-53"><a href="Functions.html#cb11-53"></a>    </span>
<span id="cb11-54"><a href="Functions.html#cb11-54"></a>  <span class="co"># partial factor</span></span>
<span id="cb11-55"><a href="Functions.html#cb11-55"></a>  partial.fi.array &lt;-<span class="st"> </span>partial.fi.array</span>
<span id="cb11-56"><a href="Functions.html#cb11-56"></a>  MFA.fi.groups.means &lt;-<span class="st"> </span>PTCA4CATA<span class="op">::</span><span class="kw">getMeans</span>(</span>
<span id="cb11-57"><a href="Functions.html#cb11-57"></a>    fs, </span>
<span id="cb11-58"><a href="Functions.html#cb11-58"></a>    DESIGN)</span>
<span id="cb11-59"><a href="Functions.html#cb11-59"></a>  <span class="kw">colnames</span>(MFA.fi.groups.means) &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;Dimension &quot;</span>, </span>
<span id="cb11-60"><a href="Functions.html#cb11-60"></a>                          <span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(MFA.fi.groups.means))</span>
<span id="cb11-61"><a href="Functions.html#cb11-61"></a>  <span class="co"># new array</span></span>
<span id="cb11-62"><a href="Functions.html#cb11-62"></a>  MFA.partial.fi.groups.means &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="dv">0</span>,<span class="dt">dim=</span><span class="kw">c</span>(<span class="kw">nrow</span>(MFA.fi.groups.means),</span>
<span id="cb11-63"><a href="Functions.html#cb11-63"></a>                                               <span class="kw">ncol</span>(MFA.fi.groups.means), </span>
<span id="cb11-64"><a href="Functions.html#cb11-64"></a>                                               mm))</span>
<span id="cb11-65"><a href="Functions.html#cb11-65"></a>  <span class="co"># for loop to calculate mean</span></span>
<span id="cb11-66"><a href="Functions.html#cb11-66"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>mm){</span>
<span id="cb11-67"><a href="Functions.html#cb11-67"></a>    MFA.partial.fi.groups.means[,,i] &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(PTCA4CATA<span class="op">::</span><span class="kw">getMeans</span>(</span>
<span id="cb11-68"><a href="Functions.html#cb11-68"></a>      partial.fi.array[,,i], </span>
<span id="cb11-69"><a href="Functions.html#cb11-69"></a>      DESIGN))</span>
<span id="cb11-70"><a href="Functions.html#cb11-70"></a>  }</span>
<span id="cb11-71"><a href="Functions.html#cb11-71"></a>  <span class="co"># setting dimnames</span></span>
<span id="cb11-72"><a href="Functions.html#cb11-72"></a>  <span class="kw">dimnames</span>(MFA.partial.fi.groups.means) &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="kw">rownames</span>(MFA.fi.groups.means),</span>
<span id="cb11-73"><a href="Functions.html#cb11-73"></a>                                                <span class="kw">colnames</span>(MFA.fi.groups.means), </span>
<span id="cb11-74"><a href="Functions.html#cb11-74"></a>                                                <span class="kw">paste0</span>(LETTERS[<span class="dv">1</span><span class="op">:</span>mm], <span class="dv">1</span><span class="op">:</span>mm))</span>
<span id="cb11-75"><a href="Functions.html#cb11-75"></a>  </span>
<span id="cb11-76"><a href="Functions.html#cb11-76"></a>  map4PFS &lt;-<span class="st"> </span><span class="kw">createPartialFactorScoresMap</span>(</span>
<span id="cb11-77"><a href="Functions.html#cb11-77"></a>    <span class="dt">factorScores =</span> MFA.fi.groups.means,</span>
<span id="cb11-78"><a href="Functions.html#cb11-78"></a>    <span class="dt">partialFactorScores =</span> MFA.partial.fi.groups.means,</span>
<span id="cb11-79"><a href="Functions.html#cb11-79"></a>    <span class="dt">axis1 =</span> d, <span class="dt">axis2 =</span> (d<span class="op">+</span><span class="dv">1</span>),</span>
<span id="cb11-80"><a href="Functions.html#cb11-80"></a>    <span class="dt">colors4Items =</span> color.dot,</span>
<span id="cb11-81"><a href="Functions.html#cb11-81"></a>    <span class="dt">colors4Blocks =</span> ,</span>
<span id="cb11-82"><a href="Functions.html#cb11-82"></a>    <span class="dt">size.points =</span> <span class="fl">1.5</span>,</span>
<span id="cb11-83"><a href="Functions.html#cb11-83"></a>    <span class="dt">alpha.points =</span> <span class="fl">0.7</span>,</span>
<span id="cb11-84"><a href="Functions.html#cb11-84"></a>    <span class="dt">alpha.lines =</span> <span class="fl">0.9</span>,</span>
<span id="cb11-85"><a href="Functions.html#cb11-85"></a>    <span class="dt">size.labels =</span> <span class="dv">3</span>,</span>
<span id="cb11-86"><a href="Functions.html#cb11-86"></a>    <span class="dt">names4Partial =</span> <span class="kw">dimnames</span>(MFA.partial.fi.groups.means)[[<span class="dv">3</span>]],</span>
<span id="cb11-87"><a href="Functions.html#cb11-87"></a>    <span class="dt">font.labels =</span> <span class="st">&#39;bold&#39;</span>)</span>
<span id="cb11-88"><a href="Functions.html#cb11-88"></a>  </span>
<span id="cb11-89"><a href="Functions.html#cb11-89"></a>  partialFS.map.a &lt;-<span class="st"> </span>factor.graph.out<span class="op">$</span>zeMap_background <span class="op">+</span><span class="st"> </span></span>
<span id="cb11-90"><a href="Functions.html#cb11-90"></a><span class="st">    </span>factor.graph.out<span class="op">$</span>zeMap_dots <span class="op">+</span></span>
<span id="cb11-91"><a href="Functions.html#cb11-91"></a><span class="st">    </span>factor.graph.out<span class="op">$</span>zeMap_text <span class="op">+</span></span>
<span id="cb11-92"><a href="Functions.html#cb11-92"></a><span class="st">    </span>MapGroup<span class="op">$</span>zeMap_dots <span class="op">+</span><span class="st"> </span></span>
<span id="cb11-93"><a href="Functions.html#cb11-93"></a><span class="st">    </span>MapGroup<span class="op">$</span>zeMap_text <span class="op">+</span><span class="st"> </span></span>
<span id="cb11-94"><a href="Functions.html#cb11-94"></a><span class="st">    </span>map4PFS<span class="op">$</span>mapColByItems <span class="op">+</span><span class="st"> </span>labels4RV</span>
<span id="cb11-95"><a href="Functions.html#cb11-95"></a>  partialFS.map.b &lt;-<span class="st"> </span>factor.graph.out<span class="op">$</span>zeMap_background <span class="op">+</span><span class="st"> </span></span>
<span id="cb11-96"><a href="Functions.html#cb11-96"></a><span class="st">    </span>map4PFS<span class="op">$</span>mapColByBlocks <span class="op">+</span><span class="st"> </span></span>
<span id="cb11-97"><a href="Functions.html#cb11-97"></a><span class="st">    </span>labels4RV <span class="op">+</span><span class="st"> </span></span>
<span id="cb11-98"><a href="Functions.html#cb11-98"></a><span class="st">    </span>MapGroup<span class="op">$</span>zeMap_dots <span class="op">+</span><span class="st"> </span></span>
<span id="cb11-99"><a href="Functions.html#cb11-99"></a><span class="st">    </span>MapGroup<span class="op">$</span>zeMap_text</span>
<span id="cb11-100"><a href="Functions.html#cb11-100"></a></span>
<span id="cb11-101"><a href="Functions.html#cb11-101"></a>  partialFS.map.b</span>
<span id="cb11-102"><a href="Functions.html#cb11-102"></a>}</span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="intro.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="Data-Intro.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown/_book/edit/master/02-Functions.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["MSA.pdf", "MSA.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
